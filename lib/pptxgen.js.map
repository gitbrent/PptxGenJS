{"version":3,"sources":["webpack:///webpack/bootstrap 7b7aedc505b29355059d","webpack:///./main.js","webpack:///./src/index.js","webpack:///./src/constante.js","webpack:///./src/ppt/slides/utils/helpers.js","webpack:///./src/ppt/slides/slide.js","webpack:///./src/exportToPptx.js","webpack:///./src/contentType.js","webpack:///./src/_rels/rels.js","webpack:///./src/docProps/appXml.js","webpack:///./src/docProps/coreXml.js","webpack:///./src/ppt/_rels/presentationXmlRels.js","webpack:///./src/ppt/slideLayouts/slideLayoutXml.js","webpack:///./src/ppt/slideLayouts/slideLayoutRelXml.js","webpack:///./src/ppt/slideMasters/slideMasterXml.js","webpack:///./src/ppt/slideMasters/slideMasterRelXml.js","webpack:///./src/ppt/theme/themeXml.js","webpack:///./src/ppt/presentationXml.js","webpack:///./src/ppt/presPropsXml.js","webpack:///./src/ppt/tableStyleXml.js","webpack:///./src/ppt/viewPropsXml.js","webpack:///./src/ppt/slides/slideXml.js","webpack:///./src/ppt/slides/utils/slideHelpers/exportTable.js","webpack:///./src/ppt/slides/utils/slideHelpers/exportImage.js","webpack:///./src/ppt/slides/utils/slideHelpers/optionAdapter.js","webpack:///./src/ppt/slides/group/slideGroup.js","webpack:///./src/ppt/slides/group/baseGroup.js","webpack:///./src/ppt/slides/shape/shape.js","webpack:///./src/ppt/slides/_rel/slideXmlRel.js","webpack:///./src/ppt/slides/table/slideTable.js"],"names":["module","exports","PptxGenJS","shapes","gObjPptxShapes","masters","gObjPptxMasters","inStrTitle","gObjPptx","title","inLayout","$","inArray","Object","keys","pptLayout","console","warn","ex","isGroup","slide","addNewSlide","tabEleId","inOpts","slideTable","addSlidesForTable","inStrExportName","exportPptx","save","LAYOUTS","name","width","height","BASE_SHAPES","RECTANGLE","LINE","APP_VER","rgbToHex","inch2Emu","getSizeFromImage","calcEmuCellHeightForStr","parseTextToLines","getShapeInfo","getSmartParseNumber","decodeXmlEntities","genXmlColorSelection","convertImgToDataURLviaCanvas","genXmlBodyProperties","genXmlTextCommand","EMU","CRLF","componentToHex","c","hex","toString","length","r","g","b","Number","isInteger","toUpperCase","inches","replace","Math","round","inImgUrl","image","Image","onload","obj","onerror","error","src","cell","inIntWidthInches","GRATIO","intCharPerInch","intCalcGratio","opts","font_size","intLineCnt","floor","text","intCellH","marginPt","Array","isArray","ONEPT","inStr","inFontSize","inWidth","U","CPL","arrLines","strCurrLine","trim","each","split","i","line","word","push","shapeName","displayName","avLst","objShape","filter","inVal","inDir","isNaN","indexOf","parseInt","color_info","back_info","outText","colorVal","fillType","internalElements","type","color","alpha","slideRel","canvas","document","createElement","ctx","getContext","drawImage","callbackImgToDataURLDone","toDataURL","log","path","objOptions","bodyProperties","bodyProp","wrap","anchor","anchorCtr","bIns","lIns","rIns","tIns","shrinkText","autoFit","text_info","text_string","slide_obj","slide_num","area_opt_data","genXmlTextData","parsedText","startInfo","bold","underline","char_spacing","rpr_info","endTag","outData","field","outTextField","pptxFields","fieldIntName","gen_private","plugs","msoffice","makeUniqueID","CreateFieldText","outTextData","total_size_i","outBreakP","breakLine","out_obj","font_face","intEmpty","data","slides","rels","rel","SLDNUMFLDID","Slide","group","slideNum","slideObjNum","inBool","hasSlideNumber","inMaster","pageNum","numb","images","addImage","x","y","cx","cy","bkgd","slideObjRels","strImgExtn","substring","toLowerCase","intRels","idx","extn","rId","Target","bkgdImgRid","back","shape","objOpts","key","addText","addShape","isNumbered","arrTabRows","inOpt","tabOpt","opt","w","h","colW","arrTemp","extend","options","objTabOpts","valign","align","jQuery","inset","strImagePath","intPosX","intPosY","intSizeX","intSizeY","strImageData","strImgData","imgObj","imageRid","inSlide","strSlideXml","aStr","propertBg","propertySpTree","propertySp","head","aStrSlideXml","join","footer","fileName","fileExtn","ExportPptx","zip","JSZip","intSlideNum","arrImages","doExportPresentation","folder","file","addAllImages","strExportName","generateAsync","then","content","saveAs","idy","id","header","exec","isBase64","test","base64","self","makeXmlContTypes","strXml","makeXmlRootRels","makeXmlApp","slideObj","makeXmlCore","Date","toISOString","makeXmlPresentationRels","intRelNum","makeXmlSlideLayout","makeXmlSlideLayoutRel","makeXmlSlideMaster","intSlideLayoutId","makeXmlSlideMasterRel","makeXmlTheme","makeXmlPresentation","intCurPos","makeXmlPresProps","makeXmlTableStyles","makeXmlViewProps","makeXmlSlide","intTableNum","objSlideData","startGroup","endGroup","generateGroup","groupStart","groupEnd","shapeType","locationAttr","generateShape","ExportTable","arrRowspanCells","intColCnt","intColW","tmp","colspan","col","intRowH","rowH","rIdx","row","cIdx","colIdx","rowspan","cellOpts","cellB","cellU","cellFont","cellFontPt","cellAlign","cellValign","cellColspan","cellRowspan","cellFontClr","optImp","cellFill","fill","intMarginPt","cellMargin","strCellText","border","strC","intW","pt","strClr","strAttr","flipH","flipV","rotate","rotateVal","SlideGroup","allShapes","nLength","nIndex","oShapes","groupIndex","j","oShape","wrapperGroupCoordinate","map","nValue","min","sStart","sGroupStart","_groupStart","sGroupEnd","_groupEnd","BaseGroup","Shape","shapeObject","coordinate","margin","isTextBox","_xmlShape","customPreset","lineAttr","line_size","line_head","line_tail","effects","ii","total_size_ii","effectsList","cbGenerateEffects","moreStyles","moreStylesAttr","outStyles","styleData","indentLevel","styleProperty","getPageNumber","outBodyOpt","total_size_j","sEndShape","fixMargin","setShapeProperty","setPrstGeom","isFillOption","isEffect","closeShapeProperty","txBody","closeShape","makeXmlSlideRel","inSlideNum","SlideTable","arrObjTabHeadRows","arrObjTabBodyRows","arrObjTabFootRows","arrObjSlides","arrRows","arrColW","arrTabColW","intTabW","emuTabCurrH","arrInchMargins","lookMargin","emuSlideTabW","emuSlideTabH","tableStyle","calcColWidth","createDataArray","paginateData","createSlides","val","find","attr","outerWidth","arrObjTabCells","arrRGB1","arrRGB2","css","intBorderW","arrRGB","strBorderC","$cell","clone","html","iTab","tab","currRow","iRow","arrCellsLines","arrCellsLineHeights","emuRowH","intMaxLineCnt","intMaxColIdx","iCell","lines","lineHeight","addHeaderToEach","headRow","newSlide","master","arrTabRowCells","addTable","url","rows","tabOpts"],"mappings":"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","file":"pptxgen.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 7b7aedc505b29355059d","import PptxGenJS from './src/index';\r\n\r\nmodule.exports = PptxGenJS;\r\n\n\n\n// WEBPACK FOOTER //\n// ./main.js","import { BASE_SHAPES, LAYOUTS, APP_VER } from './constante';\r\nimport { convertImgToDataURLviaCanvas, callbackImgToDataURLDone } from './ppt/slides/utils/helpers';\r\nimport Slide from './ppt/slides/slide';\r\nimport ExportPptx from './exportToPptx';\r\nimport SlideTable from './ppt/slides/table/slideTable';\r\n\r\nexport default class PptxGenJS {\r\n\r\n    constructor() {\r\n        //this.slideNum = 0;\r\n        this.shapes  = (typeof gObjPptxShapes  !== 'undefined') ? gObjPptxShapes  : BASE_SHAPES;\r\n      \tthis.masters = (typeof gObjPptxMasters !== 'undefined') ? gObjPptxMasters : {};\r\n    }\r\n\r\n\r\n    /**\r\n     * Gets the version of this library\r\n     */\r\n    getVersion() {\r\n        return APP_VER;\r\n    };\r\n\r\n    /**\r\n     * Sets the Presentation's Title\r\n     */\r\n    setTitle( inStrTitle ) {\r\n        Slide.gObjPptx.title = inStrTitle;\r\n    }\r\n\r\n    setLayout(inLayout){\r\n\r\n        if ( $.inArray( inLayout, Object.keys( LAYOUTS ) ) > -1 ) {\r\n            Slide.gObjPptx.pptLayout = LAYOUTS[ inLayout ];\r\n        } else {\r\n            try {\r\n                console.warn( 'UNKNOWN LAYOUT! Valid values = ' + Object.keys( LAYOUTS ) );\r\n            } catch ( ex ) {}\r\n        }\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Gets the Presentation's Slide Layout {object}: [screen4x3, screen16x9, widescreen]\r\n     */\r\n    /*    getLayout() {\r\n        return this._layout;\r\n    }*/\r\n\r\n\r\n\r\n    addNewSlide(isGroup) {\r\n        let slide = new Slide(isGroup);\r\n        return slide.addNewSlide();\r\n    }\r\n\r\n    addSlidesForTable(tabEleId, inOpts) {\r\n        let slideTable = new SlideTable();\r\n        slideTable.addSlidesForTable(tabEleId, inOpts);\r\n    }\r\n\r\n    /**\r\n     * Export the Presentation to an .pptx file\r\n     * @param {string} [inStrExportName] - Filename to use for the export\r\n     */\r\n    save( inStrExportName ) {\r\n\r\n        let exportPptx = new ExportPptx();\r\n        exportPptx.save(inStrExportName);\r\n    }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","const LAYOUTS = {\r\n    'LAYOUT_4x3': {\r\n        name: 'screen4x3',\r\n        width: 9144000,\r\n        height: 6858000\r\n    },\r\n    'LAYOUT_16x9': {\r\n        name: 'screen16x9',\r\n        width: 9144000,\r\n        height: 5143500\r\n    },\r\n    'LAYOUT_16x10': {\r\n        name: 'screen16x10',\r\n        width: 9144000,\r\n        height: 5715000\r\n    },\r\n    'LAYOUT_WIDE': {\r\n        name: 'custom',\r\n        width: 12191996,\r\n        height: 6858000\r\n    }\r\n};\r\n\r\nconst BASE_SHAPES = {\r\n    RECTANGLE: {\r\n        'displayName': 'Rectangle',\r\n        'name': 'rect',\r\n        'avLst': {}\r\n    },\r\n    LINE: {\r\n        'displayName': 'Line',\r\n        'name': 'line',\r\n        'avLst': {}\r\n    }\r\n};\r\n\r\nconst APP_VER = \"1.1.0\";\r\n\r\n\r\nexport {\r\n    LAYOUTS,\r\n    BASE_SHAPES,\r\n    APP_VER\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/constante.js","import Slide from '../slide.js';\r\nconst EMU = 914400, CRLF = '\\r\\n';\r\n\r\nfunction componentToHex(c) {\r\n    var hex = c.toString(16);\r\n    return hex.length == 1 ? \"0\" + hex : hex;\r\n}\r\n\r\n/**\r\n * Used by {addSlidesForTable} to convert RGB colors from jQuery selectors to Hex for Presentation colors\r\n */\r\nexport function rgbToHex(r, g, b) {\r\n    if (!Number.isInteger(r)) {\r\n        try {\r\n            console.warn('Integer expected!');\r\n        } catch (ex) {}\r\n    }\r\n    return (componentToHex(r) + componentToHex(g) + componentToHex(b)).toUpperCase();\r\n}\r\n\r\nexport function inch2Emu(inches) {\r\n    // FIRST: Provide Caller Safety: Numbers may get conv<->conv during flight, so be kind and do some simple checks to ensure inches were passed\r\n    // Any value over 100 damn sure isnt inches, must be EMU already, so just return it\r\n    if (inches > 100) return inches;\r\n    if (typeof inches == 'string') inches = Number(inches.replace(/in*/gi, ''));\r\n    return Math.round(EMU * inches);\r\n}\r\n\r\nexport function getSizeFromImage(inImgUrl) {\r\n    // A: Create\r\n    var image = new Image();\r\n\r\n    // B: Set onload event\r\n    image.onload = function() {\r\n        // FIRST: Check for any errors: This is the best method (try/catch wont work, etc.)\r\n        if (this.width + this.height == 0) {\r\n            return {\r\n                width: 0,\r\n                height: 0\r\n            };\r\n        }\r\n        var obj = {\r\n            width: this.width,\r\n            height: this.height\r\n        };\r\n        return obj;\r\n    };\r\n    image.onerror = function() {\r\n        try {\r\n            console.error('[Error] Unable to load image: ' + inImgUrl);\r\n        } catch (ex) {}\r\n    };\r\n\r\n    // C: Load image\r\n    image.src = inImgUrl;\r\n}\r\n\r\nexport function calcEmuCellHeightForStr(cell, inIntWidthInches) {\r\n    // FORMULA for char-per-inch: (desired chars per line) / (font size [chars-per-inch]) = (reqd print area in inches)\r\n    var GRATIO = 2.61803398875; // \"Golden Ratio\"\r\n    var intCharPerInch = -1,\r\n        intCalcGratio = 0;\r\n\r\n    // STEP 1: Calc chars-per-inch [pitch]\r\n    // SEE: CPL Formula from http://www.pearsonified.com/2012/01/characters-per-line.php\r\n    intCharPerInch = (120 / cell.opts.font_size);\r\n\r\n    // STEP 2: Calc line count\r\n    var intLineCnt = Math.floor(cell.text.length / (intCharPerInch * inIntWidthInches));\r\n    if (intLineCnt < 1) intLineCnt = 1; // Dont allow line count to be 0!\r\n\r\n    // STEP 3: Calc cell height\r\n    var intCellH = (intLineCnt * ((cell.opts.font_size * 2) / 100));\r\n    if (intLineCnt > 8) intCellH = (intCellH * 0.9);\r\n\r\n    // STEP 4: Add cell padding to height\r\n    if (cell.opts.marginPt && Array.isArray(cell.opts.marginPt)) {\r\n        intCellH += (cell.opts.marginPt[0] / ONEPT * (1 / 72)) + (cell.opts.marginPt[2] / ONEPT * (1 / 72));\r\n    } else if (cell.opts.marginPt && Number.isInteger(cell.opts.marginPt)) {\r\n        intCellH += (cell.opts.marginPt / ONEPT * (1 / 72)) + (cell.opts.marginPt / ONEPT * (1 / 72));\r\n    }\r\n\r\n    // LAST: Return size\r\n    return inch2Emu(intCellH);\r\n}\r\n\r\nexport function parseTextToLines(inStr, inFontSize, inWidth) {\r\n    var U = 2.2; // Character Constant thingy\r\n    var CPL = (inWidth / (inFontSize / U));\r\n    var arrLines = [];\r\n    var strCurrLine = '';\r\n\r\n    // A: Remove leading/trailing space\r\n    inStr = $.trim(inStr);\r\n\r\n    // B: Build line array\r\n    $.each(inStr.split('\\n'), function(i, line) {\r\n        $.each(line.split(' '), function(i, word) {\r\n            if (strCurrLine.length + word.length + 1 < CPL) {\r\n                strCurrLine += (word + \" \");\r\n            } else {\r\n                if (strCurrLine) arrLines.push(strCurrLine);\r\n                strCurrLine = (word + \" \");\r\n            }\r\n        });\r\n        // All words for this line have been exhausted, flush buffer to new line, clear line var\r\n        if (strCurrLine) arrLines.push($.trim(strCurrLine) + CRLF);\r\n        strCurrLine = \"\";\r\n    });\r\n\r\n    // C: Remove trailing linebreak\r\n    arrLines[(arrLines.length - 1)] = $.trim(arrLines[(arrLines.length - 1)]);\r\n\r\n    // D: Return lines\r\n    return arrLines;\r\n}\r\n\r\nexport function getShapeInfo(shapeName) {\r\n    if (!shapeName) return gObjPptxShapes.RECTANGLE;\r\n\r\n    if (typeof shapeName == 'object' && shapeName.name && shapeName.displayName && shapeName.avLst) return shapeName;\r\n\r\n    if (gObjPptxShapes[shapeName]) return gObjPptxShapes[shapeName];\r\n\r\n    var objShape = gObjPptxShapes.filter(function(obj) {\r\n        return obj.name == shapeName || obj.displayName;\r\n    })[0];\r\n    if (typeof objShape !== 'undefined' && objShape != null) return objShape;\r\n\r\n    return gObjPptxShapes.RECTANGLE;\r\n}\r\n\r\nexport function getSmartParseNumber(inVal, inDir, gObjPptx) {\r\n    // FIRST: Convert string numeric value if reqd\r\n    if (typeof inVal == 'string' && !isNaN(Number(inVal))) inVal = Number(inVal);\r\n\r\n    // CASE 1: Number in inches\r\n    // Figure any number less than 100 is inches\r\n    if (typeof inVal == 'number' && inVal < 100) return inch2Emu(inVal);\r\n\r\n    // CASE 2: Number is already converted to something other than inches\r\n    // Figure any number greater than 100 is not inches! :)  Just return it (its EMU already i guess??)\r\n    if (typeof inVal == 'number' && inVal >= 100) return inVal;\r\n\r\n    // CASE 3: Percentage (ex: '50%')\r\n    if (typeof inVal == 'string' && inVal.indexOf('%') > -1) {\r\n        if (inDir && inDir == 'X') return Math.round((parseInt(inVal, 10) / 100) * gObjPptx.pptLayout.width);\r\n        if (inDir && inDir == 'Y') return Math.round((parseInt(inVal, 10) / 100) * gObjPptx.pptLayout.height);\r\n        // Default: Assume width (x/cx)\r\n        return Math.round((parseInt(inVal, 10) / 100) * gObjPptx.pptLayout.width);\r\n    }\r\n\r\n    // LAST: Default value\r\n    return 0;\r\n}\r\n\r\nexport function decodeXmlEntities(inStr) {\r\n    // NOTE: Dont use short-circuit eval here as value c/b \"0\" (zero) etc.!\r\n    if (typeof inStr === 'undefined' || inStr == null) return \"\";\r\n    return inStr.toString().replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;').replace(/\\'/g, '&apos;');\r\n}\r\n\r\nexport function genXmlColorSelection(color_info, back_info) {\r\n    var outText = '';\r\n    var colorVal;\r\n    var fillType = 'solid';\r\n    var internalElements = '';\r\n\r\n    if (back_info) {\r\n        outText += '<p:bg><p:bgPr>';\r\n        outText += genXmlColorSelection(back_info, false);\r\n        outText += '<a:effectLst/>';\r\n        outText += '</p:bgPr></p:bg>';\r\n    }\r\n\r\n    if (color_info) {\r\n        if (typeof color_info == 'string') colorVal = color_info;\r\n        else {\r\n            if (color_info.type) fillType = color_info.type;\r\n            if (color_info.color) colorVal = color_info.color;\r\n            if (color_info.alpha) internalElements += '<a:alpha val=\"' + (100 - color_info.alpha) + '000\"/>';\r\n        }\r\n\r\n        switch (fillType) {\r\n            case 'solid':\r\n                outText += '<a:solidFill><a:srgbClr val=\"' + colorVal + '\">' + internalElements + '</a:srgbClr></a:solidFill>';\r\n                break;\r\n        }\r\n    }\r\n\r\n    return outText;\r\n}\r\n\r\nexport function convertImgToDataURLviaCanvas(slideRel) {\r\n    // A: Create\r\n    let image = new Image();\r\n    // B: Set onload event\r\n    image.onload = function () {\r\n        // First: Check for any errors: This is the best method (try/catch wont work, etc.)\r\n        if (this.width + this.height == 0) {\r\n            this.onerror();\r\n            return;\r\n        }\r\n        let canvas = document.createElement('CANVAS');\r\n        let ctx = canvas.getContext('2d');\r\n        canvas.height = this.height;\r\n        canvas.width = this.width;\r\n        ctx.drawImage(this, 0, 0);\r\n        // Users running on local machine will get the following error:\r\n        // \"SecurityError: Failed to execute 'toDataURL' on 'HTMLCanvasElement': Tainted canvases may not be exported.\"\r\n        // when the canvas.toDataURL call executes below.\r\n        try {\r\n            callbackImgToDataURLDone(canvas.toDataURL(slideRel.type), slideRel);\r\n        } catch (ex) {\r\n            this.onerror();\r\n            console.log(\"NOTE: Browsers wont let you load/convert local images! (search for --allow-file-access-from-files)\");\r\n            return;\r\n        }\r\n        canvas = null;\r\n    };\r\n    image.onerror = () => {\r\n        try {\r\n            console.error('[Error] Unable to load image: ' + slideRel.path);\r\n        } catch (ex) {}\r\n        // Return a predefined \"Broken image\" graphic so the user will see something on the slide\r\n        callbackImgToDataURLDone('data:image/png;base64,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', slideRel);\r\n    };\r\n    // C: Load image\r\n    image.src = slideRel.path;\r\n}\r\n\r\nexport function genXmlBodyProperties( objOptions ) {\r\n    var bodyProperties = '<a:bodyPr';\r\n\r\n    if ( objOptions && objOptions.bodyProp ) {\r\n        // A: Enable or disable textwrapping none or square:\r\n        ( objOptions.bodyProp.wrap ) ? bodyProperties += ' wrap=\"' + objOptions.bodyProp.wrap + '\" rtlCol=\"0\"' : bodyProperties += ' wrap=\"square\" rtlCol=\"0\"';\r\n\r\n        // B: Set anchorPoints bottom, center or top:\r\n        if ( objOptions.bodyProp.anchor    ) bodyProperties += ' anchor=\"' + objOptions.bodyProp.anchor + '\"';\r\n        if ( objOptions.bodyProp.anchorCtr ) bodyProperties += ' anchorCtr=\"' + objOptions.bodyProp.anchorCtr + '\"';\r\n\r\n        // C: Textbox margins [padding]:\r\n        if ( objOptions.bodyProp.bIns || objOptions.bodyProp.bIns == 0 ) bodyProperties += ' bIns=\"' + objOptions.bodyProp.bIns + '\"';\r\n        if ( objOptions.bodyProp.lIns || objOptions.bodyProp.lIns == 0 ) bodyProperties += ' lIns=\"' + objOptions.bodyProp.lIns + '\"';\r\n        if ( objOptions.bodyProp.rIns || objOptions.bodyProp.rIns == 0 ) bodyProperties += ' rIns=\"' + objOptions.bodyProp.rIns + '\"';\r\n        if ( objOptions.bodyProp.tIns || objOptions.bodyProp.tIns == 0 ) bodyProperties += ' tIns=\"' + objOptions.bodyProp.tIns + '\"';\r\n\r\n        // D: Close <a:bodyPr element\r\n        bodyProperties += '>';\r\n\r\n        // E: NEW: Add auto-fit type tags\r\n        if ( objOptions.shrinkText ) bodyProperties += '<a:normAutofit fontScale=\"85000\" lnSpcReduction=\"20000\" />'; // MS-PPT > Format Shape > Text Options: \"Shrink text on overflow\"\r\n        else if ( objOptions.bodyProp.autoFit !== false ) bodyProperties += '<a:spAutoFit/>'; // MS-PPT > Format Shape > Text Options: \"Resize shape to fit text\"\r\n\r\n        // LAST: Close bodyProp\r\n        bodyProperties += '</a:bodyPr>';\r\n    }\r\n    else {\r\n        // DEFAULT:\r\n        bodyProperties += ' wrap=\"square\" rtlCol=\"0\"></a:bodyPr>';\r\n    }\r\n\r\n    return bodyProperties;\r\n}\r\n\r\nexport function genXmlTextCommand( text_info, text_string, slide_obj, slide_num ) {\r\n\r\n    var area_opt_data = genXmlTextData( text_info, slide_obj );\r\n    var parsedText;\r\n    //var startInfo = '<a:rPr lang=\"en-US\"' + area_opt_data.font_size + area_opt_data.bold + area_opt_data.italic + area_opt_data.underline + area_opt_data.char_spacing + ' dirty=\"0\" smtClean=\"0\"' + (area_opt_data.rpr_info != '' ? ('>' + area_opt_data.rpr_info) : '/>') + '<a:t>';\r\n    var startInfo = '<a:rPr lang=\"en-US\"' + area_opt_data.font_size + area_opt_data.bold  + area_opt_data.underline + area_opt_data.char_spacing + ' dirty=\"0\" smtClean=\"0\"' + (area_opt_data.rpr_info != '' ? ('>' + area_opt_data.rpr_info) : '/>') + '<a:t>';\r\n    var endTag = '</a:r>';\r\n    var outData = '<a:r>' + startInfo;\r\n\r\n    if ( text_string.field ) {\r\n        endTag = '</a:fld>';\r\n        var outTextField = pptxFields[text_string.field];\r\n        if ( outTextField === null ) {\r\n            for ( var fieldIntName in pptxFields ) {\r\n                if ( pptxFields[fieldIntName] === text_string.field ) {\r\n                    outTextField = text_string.field;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            if ( outTextField === null ) outTextField = 'datetime';\r\n        }\r\n\r\n        outData = '<a:fld id=\"{' + gen_private.plugs.type.msoffice.makeUniqueID ( '5C7A2A3D' ) + '}\" type=\"' + outTextField + '\">' + startInfo;\r\n        outData += CreateFieldText( outTextField, slide_num );\r\n\r\n    }\r\n    else {\r\n        // Automatic support for newline - split it into multi-p:\r\n        parsedText = text_string.split( \"\\n\" );\r\n        if ( parsedText.length > 1 ) {\r\n            var outTextData = '';\r\n            for ( var i = 0, total_size_i = parsedText.length; i < total_size_i; i++ ) {\r\n                outTextData += outData + decodeXmlEntities(parsedText[i]);\r\n\r\n                if ( (i + 1) < total_size_i ) {\r\n                    outTextData += '</a:t></a:r></a:p><a:p>';\r\n                }\r\n            }\r\n\r\n            outData = outTextData;\r\n\r\n        }\r\n        else {\r\n            outData += text_string.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\r\n        }\r\n    }\r\n\r\n    var outBreakP = '';\r\n    if ( text_info.breakLine ) outBreakP += '</a:p><a:p>';\r\n\r\n    return outData + '</a:t>' + endTag + outBreakP;\r\n}\r\n\r\nfunction genXmlTextData(text_info, slide_obj) {\r\n    var out_obj = {};\r\n\r\n    out_obj.font_size = '';\r\n    out_obj.bold = '';\r\n    out_obj.underline = '';\r\n    out_obj.rpr_info = '';\r\n    out_obj.char_spacing = '';\r\n\r\n    if (typeof text_info == 'object') {\r\n        if (text_info.bold) {\r\n            out_obj.bold = ' b=\"1\"';\r\n        }\r\n\r\n        if (text_info.underline) {\r\n            out_obj.underline = ' u=\"sng\"';\r\n        }\r\n\r\n        if (text_info.font_size) {\r\n            out_obj.font_size = ' sz=\"' + text_info.font_size + '00\"';\r\n        }\r\n\r\n        if (text_info.char_spacing) {\r\n            out_obj.char_spacing = ' spc=\"' + (text_info.char_spacing * 100) + '\"';\r\n            // must also disable kerning; otherwise text won't actually expand\r\n            out_obj.char_spacing += ' kern=\"0\"';\r\n        }\r\n\r\n        if (text_info.color) {\r\n            out_obj.rpr_info += genXmlColorSelection(text_info.color);\r\n        } else if (slide_obj && slide_obj.color) {\r\n            out_obj.rpr_info += genXmlColorSelection(slide_obj.color);\r\n        }\r\n\r\n        if (text_info.font_face) {\r\n            out_obj.rpr_info += '<a:latin typeface=\"' + text_info.font_face + '\" pitchFamily=\"34\" charset=\"0\"/><a:cs typeface=\"' + text_info.font_face + '\" pitchFamily=\"34\" charset=\"0\"/>';\r\n        }\r\n    } else {\r\n        if (slide_obj && slide_obj.color) out_obj.rpr_info += genXmlColorSelection(slide_obj.color);\r\n    }\r\n\r\n    if (out_obj.rpr_info != '')\r\n        out_obj.rpr_info += '</a:rPr>';\r\n\r\n    return out_obj;\r\n}\r\n\r\nfunction callbackImgToDataURLDone(inStr, slideRel) {\r\n    var intEmpty = 0;\r\n\r\n    // STEP 1: Store base64 data for this image\r\n    slideRel.data = inStr;\r\n\r\n    // STEP 2: Call export function once all async processes have completed\r\n    $.each(Slide.gObjPptx.slides, (i, slide) => {\r\n        $.each(slide.rels, (i, rel) => {\r\n            if (rel.path == slideRel.path) rel.data = inStr;\r\n            if (!rel.data) intEmpty++;\r\n        });\r\n    });\r\n\r\n    // STEP 3: Continue export process\r\n    if (intEmpty == 0) this; //.save();\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/ppt/slides/utils/helpers.js","import { inch2Emu, genXmlColorSelection } from './utils/helpers';\r\nimport { LAYOUTS} from '../../constante';\r\n\r\n\r\nconst EMU = 914400, SLDNUMFLDID = '{F7021451-1387-4CA6-816F-3879F97B5CBC}';\r\n\r\nclass Slide {\r\n\r\n    constructor( isGroup=false ) {\r\n        this.group = isGroup;\r\n        this.slideNum = 0;\r\n        this.slideObjNum = 0;\r\n    }\r\n\r\n    static gObjPptx = {\r\n                        title: 'PresePptxGenJS Presentation',\r\n                        fileName: 'Presentation',\r\n                        fileExtn: '.pptx',\r\n                        pptLayout: LAYOUTS['LAYOUT_WIDE'],\r\n                        slides: []\r\n                      };\r\n\r\n    hasSlideNumber(inBool) {\r\n        if (inBool) Slide.gObjPptx.slides[this.slideNum].hasSlideNumber = inBool;\r\n        else return Slide.gObjPptx.slides[this.slideNum].hasSlideNumber;\r\n    }\r\n\r\n    getPageNumber() {\r\n        return this.slideNum;\r\n    }\r\n    \r\n    addNewSlide(inMaster){\r\n        this.slideNum = Slide.gObjPptx.slides.length;\r\n        let pageNum = (this.slideNum + 1);\r\n\r\n        // A: Add this SLIDE to PRESENTATION, Add default values as well\r\n        Slide.gObjPptx.slides[this.slideNum] = {};\r\n        Slide.gObjPptx.slides[this.slideNum].slide = new Slide(this.group);\r\n        Slide.gObjPptx.slides[this.slideNum].name = 'Slide ' + pageNum;\r\n        Slide.gObjPptx.slides[this.slideNum].numb = pageNum;\r\n        Slide.gObjPptx.slides[this.slideNum].data = [];\r\n        Slide.gObjPptx.slides[this.slideNum].rels = [];\r\n        Slide.gObjPptx.slides[this.slideNum].hasSlideNumber = false;\r\n\r\n        // C: Add 'Master Slide' attr to Slide if a valid master was provided\r\n        if (inMaster && this.masters) {\r\n            // A: Add images (do this before adding slide bkgd)\r\n            if (inMaster.images && inMaster.images.length > 0) {\r\n                $.each(inMaster.images, (i, image) =>{\r\n                    this.addImage(image.src, inch2Emu(image.x), inch2Emu(image.y), inch2Emu(image.cx), inch2Emu(image.cy), (image.data || ''));\r\n                });\r\n            }\r\n\r\n            // B: Add any Slide Background: Image or Fill\r\n            if (inMaster.bkgd && inMaster.bkgd.src) {\r\n                let slideObjRels = Slide.gObjPptx.slides[this.slideNum].rels;\r\n                let strImgExtn = inMaster.bkgd.src.substring(inMaster.bkgd.src.indexOf('.') + 1).toLowerCase();\r\n                if (strImgExtn == 'jpg') strImgExtn = 'jpeg';\r\n                if (strImgExtn == 'gif') strImgExtn = 'png'; // MS-PPT: canvas.toDataURL for gif comes out image/png, and PPT will show \"needs repair\" unless we do this\r\n                // TODO 1.5: The next few lines are copies from .addImage above. A bad idea thats already bit my once! So of course it's makred as future :)\r\n                var intRels = 1;\r\n                for (var idx = 0; idx < Slide.gObjPptx.slides.length; idx++) {\r\n                    intRels += Slide.gObjPptx.slides[idx].rels.length;\r\n                }\r\n                slideObjRels.push({\r\n                    path: inMaster.bkgd.src,\r\n                    type: 'image/' + strImgExtn,\r\n                    extn: strImgExtn,\r\n                    data: (inMaster.bkgd.data || ''),\r\n                    rId: (intRels + 1),\r\n                    Target: '../media/image' + intRels + '.' + strImgExtn\r\n                });\r\n                slide.bkgdImgRid = slideObjRels[slideObjRels.length - 1].rId;\r\n            } else if (inMaster.bkgd) {\r\n                slide.back = inMaster.bkgd;\r\n            }\r\n\r\n            // C: Add shapes\r\n            if (inMaster.shapes && inMaster.shapes.length > 0) {\r\n                $.each(inMaster.shapes, (i, shape) => {\r\n                    // 1: Grab all options (x, y, color, etc.)\r\n                    var objOpts = {};\r\n                    $.each(Object.keys(shape), (i, key) => {\r\n                        if (shape[key] != 'type') objOpts[key] = shape[key];\r\n                    });\r\n                    // 2: Create object using 'type'\r\n                    if (shape.type == 'text') slide.addText(shape.text, objOpts);\r\n                    else if (shape.type == 'line') slide.addShape(this.shapes.LINE, objOpts);\r\n                });\r\n            }\r\n\r\n            // D: Slide Number\r\n            if (typeof inMaster.isNumbered !== 'undefined') this.slide.hasSlideNumber(inMaster.isNumbered);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    addTable(arrTabRows, inOpt, tabOpt) {\r\n\r\n        var opt = (typeof inOpt === 'object') ? inOpt : {};\r\n        if (opt.w) opt.cx = opt.w;\r\n        if (opt.h) opt.cy = opt.h;\r\n\r\n        // STEP 1: REALITY-CHECK\r\n        if (arrTabRows == null || arrTabRows.length == 0 || !Array.isArray(arrTabRows)) {\r\n            try {\r\n                console.warn('[warn] addTable: Array expected!');\r\n            } catch (ex) {}\r\n            return null;\r\n        }\r\n\r\n        // STEP 2: Grab Slide object count\r\n        this.slideObjNum = Slide.gObjPptx.slides[this.slideNum].data.length;\r\n\r\n        // STEP 3: Set default options if needed\r\n        if (typeof opt.x === 'undefined') opt.x = (EMU / 2);\r\n        if (typeof opt.y === 'undefined') opt.y = EMU;\r\n        if (typeof opt.cx === 'undefined') opt.cx = (Slide.gObjPptx.pptLayout.width - (EMU / 2));\r\n        // Dont do this for cy - leaving it null triggers auto-rowH in makeXMLSlide function\r\n\r\n        // STEP 4: We use different logic in makeSlide (smartCalc is not used), so convert to EMU now\r\n        if (opt.x < 20) opt.x = inch2Emu(opt.x);\r\n        if (opt.y < 20) opt.y = inch2Emu(opt.y);\r\n        if (opt.w < 20) opt.w = inch2Emu(opt.w);\r\n        if (opt.h < 20) opt.h = inch2Emu(opt.h);\r\n        if (opt.cx < 20) opt.cx = inch2Emu(opt.cx);\r\n        if (opt.cy && opt.cy < 20) opt.cy = inch2Emu(opt.cy);\r\n        //\r\n        if (tabOpt && Array.isArray(tabOpt.colW)) {\r\n            $.each(tabOpt.colW, function(i, colW) {\r\n                if (colW < 20) tabOpt.colW[i] = inch2Emu(colW);\r\n            });\r\n        }\r\n\r\n        // Handle case where user passed in a simple array\r\n        var arrTemp = $.extend(true, [], arrTabRows);\r\n        if (!Array.isArray(arrTemp[0])) arrTemp = [$.extend(true, [], arrTabRows)];\r\n\r\n        // STEP 5: Add data\r\n        // NOTE: Use extend to avoid mutation\r\n        Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum] = {\r\n            type: 'table',\r\n            arrTabRows: arrTemp,\r\n            options: $.extend(true, {}, opt),\r\n            objTabOpts: ($.extend(true, {}, tabOpt) || {})\r\n        };\r\n\r\n        // LAST: Return this Slide object\r\n        return this;\r\n    }\r\n\r\n    addText(text, opt) {\r\n        // STEP 1: Grab Slide object count\r\n        this.slideObjNum = Slide.gObjPptx.slides[this.slideNum].data.length;\r\n\r\n        // ROBUST: Convert attr values that will likely be passed by users to valid OOXML values\r\n        if (opt.valign) opt.valign = opt.valign.toLowerCase().replace(/^c.*/i, 'ctr').replace(/^m.*/i, 'ctr').replace(/^t.*/i, 't').replace(/^b.*/i, 'b');\r\n        if (opt.align) opt.align = opt.align.toLowerCase().replace(/^c.*/i, 'center').replace(/^m.*/i, 'center').replace(/^l.*/i, 'left').replace(/^r.*/i, 'right');\r\n\r\n        // STEP 2: Set props\r\n        Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum] = {};\r\n        Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum].type = 'text';\r\n        Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum].text = text;\r\n        Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum].options = (typeof opt === 'object') ? opt : {};\r\n        Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum].options.bodyProp = jQuery.extend({}, opt.bodyProp);\r\n        Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum].options.bodyProp.autoFit = (opt.autoFit || false); // If true, shape will collapse to text size (Fit To Shape)\r\n        Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum].options.bodyProp.anchor = (opt.valign || 'ctr'); // VALS: [t,ctr,b]\r\n        if ((opt.inset && !isNaN(Number(opt.inset))) || opt.inset == 0) {\r\n            Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum].options.bodyProp.lIns = inch2Emu(opt.inset);\r\n            Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum].options.bodyProp.rIns = inch2Emu(opt.inset);\r\n            Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum].options.bodyProp.tIns = inch2Emu(opt.inset);\r\n            Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum].options.bodyProp.bIns = inch2Emu(opt.inset);\r\n        }\r\n\r\n        // LAST: Return\r\n        return this;\r\n    }\r\n\r\n    addShape(shape, opt) {\r\n        // STEP 1: Grab Slide object count\r\n        this.slideObjNum = Slide.gObjPptx.slides[this.slideNum].data.length;\r\n\r\n        // STEP 2: Set props\r\n        Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum] = {};\r\n        Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum].type = 'text';\r\n        Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum].options = (typeof opt == 'object') ? opt : {};\r\n        Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum].options.shape = shape;\r\n\r\n        return this;\r\n    }\r\n\r\n    addImage(strImagePath, intPosX, intPosY, intSizeX, intSizeY, strImageData, strImgData) {\r\n        var intRels = 1;\r\n\r\n        // FIRST: Set vars for this image (object param replaces positional args in 1.1.0)\r\n        // TODO: FUTURE: DEPRECATED: Only allow object param in 1.5 or 2.0\r\n        if ( typeof strImagePath === 'object' ) {\r\n            intPosX = (strImagePath.x || 0);\r\n            intPosY = (strImagePath.y || 0);\r\n            intSizeX = (strImagePath.cx || strImagePath.w || 0);\r\n            intSizeY = (strImagePath.cy || strImagePath.h || 0);\r\n            strImageData = (strImagePath.data || '');\r\n            strImagePath = (strImagePath.path || ''); // This line must be last as were about to ovewrite ourself!\r\n        }\r\n        // REALITY-CHECK:\r\n        if (!strImagePath && !strImgData) {\r\n            try {\r\n                console.error(\"ERROR: Image can't be empty\");\r\n            } catch (ex) {}\r\n            return null;\r\n        }\r\n\r\n        // STEP 1: Set vars for this Slide\r\n        this.slideObjNum = Slide.gObjPptx.slides[this.slideNum].data.length;\r\n        var slideObjRels = Slide.gObjPptx.slides[this.slideNum].rels;\r\n        var strImgExtn = 'png'; // Every image is encoded via canvas>base64, so they all come out as png (use of another extn will cause \"needs repair\" dialog on open in PPT)\r\n\r\n        Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum] = {};\r\n        Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum].type = 'image';\r\n        Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum].image = strImagePath;\r\n\r\n        // STEP 2: Set image properties & options\r\n        // TODO 1.1: Measure actual image when no intSizeX/intSizeY params passed\r\n        // ....: This is an async process: we need to make getSizeFromImage use callback, then set H/W...\r\n        // if ( !intSizeX || !intSizeY ) { var imgObj = getSizeFromImage(strImagePath);\r\n        var imgObj = {\r\n            width: 1,\r\n            height: 1\r\n        };\r\n        Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum].options = {};\r\n        Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum].options.x = (intPosX || 0);\r\n        Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum].options.y = (intPosY || 0);\r\n        Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum].options.cx = (intSizeX || imgObj.width);\r\n        Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum].options.cy = (intSizeY || imgObj.height);\r\n\r\n        // STEP 3: Add this image to this Slide Rels (rId/rels count spans all slides! Count all images to get next rId)\r\n        // NOTE: rId starts at 2 (hence the intRels+1 below) as slideLayout.xml is rId=1!\r\n        $.each(Slide.gObjPptx.slides, function(i, slide) {\r\n            intRels += slide.rels.length;\r\n        });\r\n        slideObjRels.push({\r\n            path: strImagePath,\r\n            type: 'image/' + strImgExtn,\r\n            extn: strImgExtn,\r\n            data: (strImgData || ''),\r\n            rId: (intRels + 1),\r\n            Target: '../media/image' + intRels + '.' + strImgExtn\r\n        });\r\n        Slide.gObjPptx.slides[this.slideNum].data[this.slideObjNum].imageRid = slideObjRels[slideObjRels.length - 1].rId;\r\n\r\n        // LAST: Return this Slide\r\n        return this;\r\n    }\r\n\r\n    static header(inSlide){\r\n\r\n        let strSlideXml, aStr=[], propertBg = [], propertySpTree=[], propertySp=[];\r\n\r\n        let head =`<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n<p:sld xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\"><p:cSld name=\"${inSlide.name}\">`;\r\n        aStr.push(head);\r\n\r\n        // STEP 2: Add background color or background image (if any)\r\n        // A: Background color\r\n        /*if ( inSlide.slide.back ) strSlideXml += genXmlColorSelection(false, inSlide.slide.back);\r\n        // B: Add background image (using Strech) (if any)\r\n        if ( inSlide.slide.bkgdImgRid ) {\r\n            // TODO 1.0: We should be doing this in the slideLayout...\r\n            strSlideXml += `<p:bg>\r\n                            <p:bgPr><a:blipFill dpi=\"0\" rotWithShape=\"1\">\r\n                                <a:blip r:embed=\"rId${inSlide.slide.bkgdImgRid}\"><a:lum/></a:blip>\r\n                                <a:srcRect/><a:stretch><a:fillRect/></a:stretch></a:blipFill>\r\n                                <a:effectLst/></p:bgPr>\r\n                         </p:bg>`;\r\n        } */\r\n\r\n        if ( inSlide.slide.back ) aStrSlideXml.push(genXmlColorSelection(false, inSlide.slide.back));\r\n        // B: Add background image (using Strech) (if any)\r\n        if ( inSlide.slide.bkgdImgRid ) {\r\n            // TODO 1.0: We should be doing this in the slideLayout...\r\n            propertBg = [`<p:bg>`,\r\n                `<p:bgPr><a:blipFill dpi=\"0\" rotWithShape=\"1\">`,\r\n                `<a:blip r:embed=\"rId${inSlide.slide.bkgdImgRid}\"><a:lum/></a:blip>`,\r\n                `<a:srcRect/><a:stretch><a:fillRect/></a:stretch></a:blipFill>`,\r\n                `<a:effectLst/></p:bgPr>`,\r\n                `</p:bg>`\r\n            ];\r\n            aStr.push(propertBg.join(''))\r\n        }\r\n        propertySpTree = [`<p:spTree>`,\r\n            `<p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/><p:nvPr/></p:nvGrpSpPr>`,\r\n            `<p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"0\" cy=\"0\"/>`,\r\n            `<a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/></a:xfrm></p:grpSpPr>`];\r\n\r\n            aStr.push(propertySpTree.join(''));\r\n\r\n// STEP 4: Add slide numbers if selected\r\n        // TODO 1.0: Fixed location sucks! Place near bottom corner using slide.size !!!\r\n        if ( inSlide.hasSlideNumber ) {\r\n            propertySp = [`<p:sp>`,\r\n                              `<p:nvSpPr>`,\r\n                              `<p:cNvPr id=\"25\" name=\"Shape 25\"/><p:cNvSpPr/><p:nvPr><p:ph type=\"sldNum\" sz=\"quarter\" idx=\"4294967295\"/></p:nvPr></p:nvSpPr>`,\r\n                              `<p:spPr>`,\r\n                                `<a:xfrm><a:off x=\"${(EMU*0.3)}\" y=\"${(EMU*5.2)}\"/><a:ext cx=\"400000\" cy=\"300000\"/></a:xfrm>`,\r\n                                `<a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom>`,\r\n                                `<a:extLst>`,\r\n                                `<a:ext uri=\"{C572A759-6A51-4108-AA02-DFA0A04FC94B}\">`,\r\n                                  `<ma14:wrappingTextBoxFlag val=\"0\" xmlns:ma14=\"http://schemas.microsoft.com/office/mac/drawingml/2011/main\"/></a:ext>`,\r\n                                `</a:extLst>`,\r\n                              `</p:spPr>`,\r\n                              `<p:txBody><a:bodyPr/><a:lstStyle/><a:p><a:pPr/><a:fld id=\"${SLDNUMFLDID}\" type=\"slidenum\"/></a:p></p:txBody>`,\r\n                              `</p:sp>`];\r\n            aStr.push(propertySp.join(''))\r\n\r\n        }\r\n        strSlideXml = aStr.join('');\r\n        return strSlideXml;\r\n    }\r\n\r\n    static footer(){\r\n        let footer= [\r\n            `</p:spTree>`,\r\n                `</p:cSld>`,\r\n                `<p:clrMapOvr>`,\r\n                    `<a:masterClrMapping/>`,\r\n                `</p:clrMapOvr>`,\r\n            `</p:sld>`\r\n            ];\r\n        return footer.join('');\r\n    }\r\n\r\n}\r\n\r\nexport default Slide\n\n\n// WEBPACK FOOTER //\n// ./src/ppt/slides/slide.js","import ContentType from './contentType';\r\nimport rels from './_rels/rels';\r\nimport appXml from './docProps/appXml';\r\nimport coreXml from './docProps/coreXml';\r\nimport presentationXmlRels from './ppt/_rels/presentationXmlRels';\r\nimport slideLayoutXml from './ppt/slideLayouts/slideLayoutXml';\r\nimport slideLayoutRelXml from './ppt/slideLayouts/slideLayoutRelXml';\r\nimport slideMasterXml from './ppt/slideMasters/slideMasterXml';\r\nimport slideMasterRelXml from './ppt/slideMasters/slideMasterRelXml';\r\nimport themeXml from './ppt/theme/themeXml';\r\nimport presentationXml from './ppt/presentationXml';\r\nimport presPropsXml from './ppt/presPropsXml';\r\nimport tableStyleXml from './ppt/tableStyleXml';\r\nimport viewPropsXml from './ppt/viewPropsXml';\r\nimport slideXml from './ppt/slides/slideXml';\r\nimport slideXmlRel from './ppt/slides/_rel/slideXmlRel';\r\nimport Slide from 'ppt/slides/slide.js';\r\n\r\n\r\nexport default class ExportPptx {\r\n\r\n    constructor() {\r\n\r\n        this.gObjPptx = Slide.gObjPptx;\r\n        this.zip = new JSZip();\r\n        //this.zip = new com.sap.powerdesigner.web.galilei.common.util.Zip.create();\r\n        this.intSlideNum = 0;\r\n        this.intRels = 0;\r\n    }\r\n\r\n    save(inStrExportName){\r\n\r\n        let intRels = 0,\r\n            arrImages = [];\r\n\r\n        // STEP 1: Set export title (if any)\r\n        if ( inStrExportName ) this.gObjPptx.fileName = inStrExportName;\r\n\r\n        // STEP 2: Total all images (rels) across the Presentation\r\n        // PERF: Only send unique image paths for encoding (encoding func will find and fill ALL matching img paths and fill)\r\n        let slides = this.gObjPptx.slides;\r\n        $.each( slides, ( i, slide ) => {\r\n            $.each( slide.rels, ( i, rel ) => {\r\n                if ( !rel.data && $.inArray( rel.path, arrImages ) == -1 ) {\r\n                    intRels++;\r\n                    this.convertImgToDataURLviaCanvas( rel, this.callbackImgToDataURLDone );\r\n                    arrImages.push( rel.path );\r\n                }\r\n            } );\r\n        } );\r\n\r\n        // STEP 3: Export now if there's no images to encode (otherwise, last async imgConvert call above will call exportFile)\r\n        if ( intRels == 0 ) {\r\n            this.doExportPresentation();\r\n        };\r\n    }\r\n\r\n    doExportPresentation() {\r\n        this.zip.folder( \"_rels\" );\r\n        this.zip.folder( \"docProps\" );\r\n        this.zip.folder( \"ppt\" ).folder( \"_rels\" );\r\n        this.zip.folder( \"ppt/media\" );\r\n        this.zip.folder( \"ppt/slideLayouts\" ).folder( \"_rels\" );\r\n        this.zip.folder( \"ppt/slideMasters\" ).folder( \"_rels\" );\r\n        this.zip.folder( \"ppt/slides\" ).folder( \"_rels\" );\r\n        this.zip.folder( \"ppt/theme\" );\r\n\r\n        this.zip.file( \"[Content_Types].xml\", ContentType(this.gObjPptx) );\r\n        this.zip.file( \"_rels/.rels\", rels() );\r\n        this.zip.file( \"docProps/app.xml\", appXml(this.gObjPptx) );\r\n        this.zip.file( \"docProps/core.xml\", coreXml(this.gObjPptx) );\r\n        this.zip.file( \"ppt/_rels/presentation.xml.rels\", presentationXmlRels(this.gObjPptx) );\r\n\r\n        // Create a Layout/Master/Rel/Slide file for each SLIDE\r\n        for ( var idx = 0; idx < this.gObjPptx.slides.length; idx++ ) {\r\n            this.intSlideNum++;\r\n            this.zip.file( \"ppt/slideLayouts/slideLayout\" + this.intSlideNum + \".xml\", slideLayoutXml() );\r\n            this.zip.file( \"ppt/slideLayouts/_rels/slideLayout\" + this.intSlideNum + \".xml.rels\", slideLayoutRelXml() );\r\n            this.zip.file( \"ppt/slides/slide\" + this.intSlideNum + \".xml\", slideXml( this.gObjPptx.slides[ idx ], this.gObjPptx ) );\r\n            this.zip.file( \"ppt/slides/_rels/slide\" + this.intSlideNum + \".xml.rels\", slideXmlRel( this.intSlideNum, this.gObjPptx ) );\r\n        }\r\n        this.zip.file( \"ppt/slideMasters/slideMaster1.xml\", slideMasterXml(this.gObjPptx) );\r\n        this.zip.file( \"ppt/slideMasters/_rels/slideMaster1.xml.rels\", slideMasterRelXml(this.gObjPptx) );\r\n\r\n        // Add all images\r\n        this.addAllImages();\r\n\r\n        this.zip.file( \"ppt/theme/theme1.xml\", themeXml() );\r\n        this.zip.file( \"ppt/presentation.xml\", presentationXml(this.gObjPptx) );\r\n        this.zip.file( \"ppt/presProps.xml\", presPropsXml() );\r\n        this.zip.file( \"ppt/tableStyles.xml\", tableStyleXml() );\r\n        this.zip.file( \"ppt/viewProps.xml\", viewPropsXml() );\r\n\r\n        // =======\r\n        // STEP 3: Push the PPTX file to browser\r\n        // =======\r\n        var strExportName = ( ( this.gObjPptx.fileName.toLowerCase().indexOf( '.ppt' ) > -1 ) ? this.gObjPptx.fileName : this.gObjPptx.fileName + this.gObjPptx.fileExtn );\r\n        this.zip.generateAsync( {\r\n            type: \"blob\"\r\n        } ).then( function( content ) {\r\n            //sap.galilei.ui.common.FileManager.saveAs( content, strExportName );\r\n            saveAs( content, strExportName );\r\n            Slide.gObjPptx.slides = [];\r\n        });\r\n\r\n    }\r\n\r\n    addAllImages() {\r\n        for (var idx = 0; idx < this.gObjPptx.slides.length; idx++) {\r\n            for (var idy = 0; idy < this.gObjPptx.slides[idx].rels.length; idy++) {\r\n                var id = this.gObjPptx.slides[idx].rels[idy].rId - 1;\r\n                var data = this.gObjPptx.slides[idx].rels[idy].data;\r\n                // data:image/png;base64\r\n                var header = data.substring(0, data.indexOf(\",\"));\r\n                // NOTE: Trim the leading 'data:image/png;base64,' text as it is not needed (and image wont render correctly with it)\r\n                var content = data.substring(data.indexOf(\",\") + 1);\r\n                var extn = /data:image\\/(\\w+)/.exec(header)[1];\r\n                var isBase64 = /base64/.test(header);\r\n                this.zip.file(\"ppt/media/image\" + id + \".\" + extn, content, {\r\n                    base64: isBase64\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    convertImgToDataURLviaCanvas(slideRel) {\r\n        // A: Create\r\n        var self = this;\r\n        var image = new Image();\r\n        // B: Set onload event\r\n        image.onload = function() {\r\n            // First: Check for any errors: This is the best method (try/catch wont work, etc.)\r\n            if (this.width + this.height == 0) {\r\n                this.onerror();\r\n                return;\r\n            }\r\n            var canvas = document.createElement('CANVAS');\r\n            var ctx = canvas.getContext('2d');\r\n            canvas.height = this.height;\r\n            canvas.width = this.width;\r\n            ctx.drawImage(this, 0, 0);\r\n            // Users running on local machine will get the following error:\r\n            // \"SecurityError: Failed to execute 'toDataURL' on 'HTMLCanvasElement': Tainted canvases may not be exported.\"\r\n            // when the canvas.toDataURL call executes below.\r\n            try {\r\n                self.callbackImgToDataURLDone(canvas.toDataURL(slideRel.type), slideRel);\r\n            } catch (ex) {\r\n                this.onerror();\r\n                console.log(\"NOTE: Browsers wont let you load/convert local images! (search for --allow-file-access-from-files)\");\r\n                return;\r\n            }\r\n            canvas = null;\r\n        };\r\n        image.onerror = function() {\r\n            try {\r\n                console.error('[Error] Unable to load image: ' + slideRel.path);\r\n            } catch (ex) {}\r\n            // Return a predefined \"Broken image\" graphic so the user will see something on the slide\r\n            self.callbackImgToDataURLDone('data:image/png;base64,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', slideRel);\r\n        };\r\n        // C: Load image\r\n        image.src = slideRel.path;\r\n    }\r\n\r\n    callbackImgToDataURLDone(inStr, slideRel) {\r\n        var intEmpty = 0;\r\n\r\n        // STEP 1: Store base64 data for this image\r\n        slideRel.data = inStr;\r\n\r\n        // STEP 2: Call export function once all async processes have completed\r\n        $.each(this.gObjPptx.slides, function(i, slide) {\r\n            $.each(slide.rels, function(i, rel) {\r\n                if (rel.path == slideRel.path) rel.data = inStr;\r\n                if (!rel.data) intEmpty++;\r\n            });\r\n        });\r\n\r\n        // STEP 3: Continue export process\r\n        if (intEmpty == 0) this.doExportPresentation();\r\n    }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/exportToPptx.js","export default function makeXmlContTypes(gObjPptx) {\r\n    const CRLF = '\\r\\n';\r\n\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + CRLF +\r\n        '<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">' +\r\n        ' <Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\"/>' +\r\n        ' <Default Extension=\"xml\" ContentType=\"application/xml\"/>' +\r\n        ' <Default Extension=\"jpeg\" ContentType=\"image/jpeg\"/>' +\r\n        ' <Default Extension=\"png\" ContentType=\"image/png\"/>' +\r\n        ' <Override PartName=\"/docProps/app.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.extended-properties+xml\"/>' +\r\n        ' <Override PartName=\"/ppt/theme/theme1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.theme+xml\"/>' +\r\n        ' <Override PartName=\"/docProps/core.xml\" ContentType=\"application/vnd.openxmlformats-package.core-properties+xml\"/>' +\r\n        ' <Override PartName=\"/ppt/presProps.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.presProps+xml\"/>' +\r\n        ' <Override PartName=\"/ppt/presentation.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml\"/>' +\r\n        ' <Override PartName=\"/ppt/tableStyles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml\"/>' +\r\n        ' <Override PartName=\"/ppt/viewProps.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.viewProps+xml\"/>';\r\n    $.each( gObjPptx.slides, function( idx, slide ) {\r\n        strXml += '<Override PartName=\"/ppt/slideMasters/slideMaster' + ( idx + 1 ) + '.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml\"/>';\r\n        strXml += '<Override PartName=\"/ppt/slideLayouts/slideLayout' + ( idx + 1 ) + '.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml\"/>';\r\n        strXml += '<Override PartName=\"/ppt/slides/slide' + ( idx + 1 ) + '.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.slide+xml\"/>';\r\n    } );\r\n    strXml += '</Types>';\r\n    return strXml;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/contentType.js","export default function makeXmlRootRels() {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n' +\r\n        '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' +\r\n        '  <Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\" Target=\"docProps/app.xml\"/>' +\r\n        '  <Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\" Target=\"docProps/core.xml\"/>' +\r\n        '  <Relationship Id=\"rId3\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"ppt/presentation.xml\"/>' +\r\n        '</Relationships>';\r\n    return strXml;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/_rels/rels.js","export default function makeXmlApp(gObjPptx) {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n\\\r\n\t\t\t\t\t<Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\" xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\">\\\r\n\t\t\t\t\t\t<TotalTime>0</TotalTime>\\\r\n\t\t\t\t\t\t<Words>0</Words>\\\r\n\t\t\t\t\t\t<Application>Microsoft Office PowerPoint</Application>\\\r\n\t\t\t\t\t\t<PresentationFormat>On-screen Show (4:3)</PresentationFormat>\\\r\n\t\t\t\t\t\t<Paragraphs>0</Paragraphs>\\\r\n\t\t\t\t\t\t<Slides>' + gObjPptx.slides.length + '</Slides>\\\r\n\t\t\t\t\t\t<Notes>0</Notes>\\\r\n\t\t\t\t\t\t<HiddenSlides>0</HiddenSlides>\\\r\n\t\t\t\t\t\t<MMClips>0</MMClips>\\\r\n\t\t\t\t\t\t<ScaleCrop>false</ScaleCrop>\\\r\n\t\t\t\t\t\t<HeadingPairs>\\\r\n\t\t\t\t\t\t  <vt:vector size=\"4\" baseType=\"variant\">\\\r\n\t\t\t\t\t\t    <vt:variant><vt:lpstr>Theme</vt:lpstr></vt:variant>\\\r\n\t\t\t\t\t\t    <vt:variant><vt:i4>1</vt:i4></vt:variant>\\\r\n\t\t\t\t\t\t    <vt:variant><vt:lpstr>Slide Titles</vt:lpstr></vt:variant>\\\r\n\t\t\t\t\t\t    <vt:variant><vt:i4>' + gObjPptx.slides.length + '</vt:i4></vt:variant>\\\r\n\t\t\t\t\t\t  </vt:vector>\\\r\n\t\t\t\t\t\t</HeadingPairs>\\\r\n\t\t\t\t\t\t<TitlesOfParts>';\r\n    strXml += '<vt:vector size=\"' + ( gObjPptx.slides.length + 1 ) + '\" baseType=\"lpstr\">';\r\n    strXml += '<vt:lpstr>Office Theme</vt:lpstr>';\r\n    $.each( gObjPptx.slides, function( idx, slideObj ) {\r\n        strXml += '<vt:lpstr>Slide ' + ( idx + 1 ) + '</vt:lpstr>';\r\n    } );\r\n    strXml += ` </vt:vector>\\r\\n\r\n          </TitlesOfParts>\\r\\n\r\n          <Company>PptxGenJS</Company>\\r\\n\r\n          <LinksUpToDate>false</LinksUpToDate>\\r\\n\r\n          <SharedDoc>false</SharedDoc>\\r\\n\r\n          <HyperlinksChanged>false</HyperlinksChanged>\\r\\n\r\n          <AppVersion>15.0000</AppVersion>\\r\\n\r\n        </Properties>`;\r\n    return strXml;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/docProps/appXml.js","export default function makeXmlCore( gObjPptx ) {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n\\\r\n\t\t\t\t\t\t<cp:coreProperties xmlns:cp=\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\"\\\r\n\t\t\t\t\t\t\t xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:dcterms=\"http://purl.org/dc/terms/\"\\\r\n\t\t\t\t\t\t\t xmlns:dcmitype=\"http://purl.org/dc/dcmitype/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\\\r\n\t\t\t\t\t\t\t<dc:title>' + gObjPptx.title + '</dc:title>\\\r\n\t\t\t\t\t\t\t<dc:creator>PptxGenJS</dc:creator>\\\r\n\t\t\t\t\t\t\t<cp:lastModifiedBy>PptxGenJS</cp:lastModifiedBy>\\\r\n\t\t\t\t\t\t\t<cp:revision>1</cp:revision>\\\r\n\t\t\t\t\t\t\t<dcterms:created xsi:type=\"dcterms:W3CDTF\">' + new Date().toISOString() + '</dcterms:created>\\\r\n\t\t\t\t\t\t\t<dcterms:modified xsi:type=\"dcterms:W3CDTF\">' + new Date().toISOString() + '</dcterms:modified>\\\r\n\t\t\t\t\t\t</cp:coreProperties>';\r\n    return strXml;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/docProps/coreXml.js","export default function makeXmlPresentationRels(gObjPptx) {\r\n  var intRelNum = 0;\r\n  var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n'\r\n        + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">';\r\n\r\n  strXml += '  <Relationship Id=\"rId1\" Target=\"slideMasters/slideMaster1.xml\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster\"/>';\r\n  intRelNum++;\r\n\r\n  for ( var idx=1; idx<=gObjPptx.slides.length; idx++ ) {\r\n    intRelNum++;\r\n    strXml += '  <Relationship Id=\"rId'+ intRelNum +'\" Target=\"slides/slide'+ idx +'.xml\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide\"/>';\r\n  }\r\n  intRelNum++;\r\n  strXml += '  <Relationship Id=\"rId'+  intRelNum    +'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/presProps\" Target=\"presProps.xml\"/>'\r\n      + '  <Relationship Id=\"rId'+ (intRelNum+1) +'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/viewProps\" Target=\"viewProps.xml\"/>'\r\n      + '  <Relationship Id=\"rId'+ (intRelNum+2) +'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\" Target=\"theme/theme1.xml\"/>'\r\n      + '  <Relationship Id=\"rId'+ (intRelNum+3) +'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles\" Target=\"tableStyles.xml\"/>'\r\n      + '</Relationships>';\r\n  return strXml;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ppt/_rels/presentationXmlRels.js","export default function makeXmlSlideLayout() {\r\n  let strXml;\r\n  const SLDNUMFLDID = '{F7021451-1387-4CA6-816F-3879F97B5CBC}';\r\n\r\n  strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';\r\n  strXml += '<p:sldLayout xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\" type=\"title\" preserve=\"1\">\\r\\n'\r\n      + '<p:cSld name=\"Title Slide\">'\r\n      + '<p:spTree><p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/><p:nvPr/></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"0\" cy=\"0\"/><a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/></a:xfrm></p:grpSpPr>'\r\n      + '<p:sp><p:nvSpPr><p:cNvPr id=\"2\" name=\"Title 1\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"ctrTitle\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"685800\" y=\"2130425\"/><a:ext cx=\"7772400\" cy=\"1470025\"/></a:xfrm></p:spPr><p:txBody><a:bodyPr/><a:lstStyle/><a:p><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp>'\r\n      + '<p:sp><p:nvSpPr><p:cNvPr id=\"3\" name=\"Subtitle 2\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"subTitle\" idx=\"1\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"1371600\" y=\"3886200\"/><a:ext cx=\"6400800\" cy=\"1752600\"/></a:xfrm></p:spPr><p:txBody><a:bodyPr/><a:lstStyle>'\r\n      + '  <a:lvl1pPr marL=\"0\"       indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr>'\r\n      + '  <a:lvl2pPr marL=\"457200\"  indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl2pPr>'\r\n      + '  <a:lvl3pPr marL=\"914400\"  indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl3pPr>'\r\n      + '  <a:lvl4pPr marL=\"1371600\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl4pPr>'\r\n      + '  <a:lvl5pPr marL=\"1828800\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl5pPr>'\r\n      + '  <a:lvl6pPr marL=\"2286000\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl6pPr>'\r\n      + '  <a:lvl7pPr marL=\"2743200\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl7pPr>'\r\n      + '  <a:lvl8pPr marL=\"3200400\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl8pPr>'\r\n      + '  <a:lvl9pPr marL=\"3657600\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl9pPr></a:lstStyle><a:p><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Click to edit Master subtitle style</a:t></a:r><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr>'\r\n      + '<p:cNvPr id=\"4\" name=\"Date Placeholder 3\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"dt\" sz=\"half\" idx=\"10\"/></p:nvPr></p:nvSpPr><p:spPr/><p:txBody><a:bodyPr/><a:lstStyle/><a:p><a:fld id=\"{F8166F1F-CE9B-4651-A6AA-CD717754106B}\" type=\"datetimeFigureOut\"><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>01/01/2016</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr>'\r\n      + '<p:cNvPr id=\"5\" name=\"Footer Placeholder 4\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"ftr\" sz=\"quarter\" idx=\"11\"/></p:nvPr></p:nvSpPr><p:spPr/><p:txBody><a:bodyPr/><a:lstStyle/><a:p><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr>'\r\n      + '<p:cNvPr id=\"6\" name=\"Slide Number Placeholder 5\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"sldNum\" sz=\"quarter\" idx=\"12\"/></p:nvPr></p:nvSpPr><p:spPr/><p:txBody><a:bodyPr/><a:lstStyle/><a:p><a:fld id=\"'+SLDNUMFLDID+'\" type=\"slidenum\"><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t></a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp></p:spTree></p:cSld>'\r\n      + '<p:clrMapOvr><a:masterClrMapping/></p:clrMapOvr></p:sldLayout>';\r\n  //\r\n  return strXml;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ppt/slideLayouts/slideLayoutXml.js","//export function makeXmlSlideLayoutRel(inSlideNum) {\r\nexport default function makeXmlSlideLayoutRel() {\r\n  var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';\r\n    strXml += '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\\r\\n';\r\n    //?strXml += '  <Relationship Id=\"rId'+ inSlideNum +'\" Target=\"../slideMasters/slideMaster'+ inSlideNum +'.xml\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster\"/>';\r\n    //strXml += '  <Relationship Id=\"rId1\" Target=\"../slideMasters/slideMaster'+ inSlideNum +'.xml\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster\"/>';\r\n    strXml += '  <Relationship Id=\"rId1\" Target=\"../slideMasters/slideMaster1.xml\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster\"/>\\r\\n';\r\n    strXml += '</Relationships>';\r\n  //\r\n  return strXml;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ppt/slideLayouts/slideLayoutRelXml.js","export default function makeXmlSlideMaster(gObjPptx) {\r\n  let intSlideLayoutId = 2147483649;\r\n  const SLDNUMFLDID = '{F7021451-1387-4CA6-816F-3879F97B5CBC}';\r\n  let strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n'\r\n        + '<p:sldMaster xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\">\\r\\n'\r\n        + '  <p:cSld><p:bg><p:bgRef idx=\"1001\"><a:schemeClr val=\"bg1\"/></p:bgRef></p:bg><p:spTree><p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/><p:nvPr/></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"0\" cy=\"0\"/><a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr>\\r\\n'\r\n        + '<p:cNvPr id=\"2\" name=\"Title Placeholder 1\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"title\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"457200\" y=\"274638\"/><a:ext cx=\"8229600\" cy=\"1143000\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"ctr\"><a:normAutofit/></a:bodyPr><a:lstStyle/><a:p><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr>\\r\\n'\r\n        + '<p:cNvPr id=\"3\" name=\"Text Placeholder 2\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"body\" idx=\"1\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"457200\" y=\"1600200\"/><a:ext cx=\"8229600\" cy=\"4525963\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\"><a:normAutofit/></a:bodyPr><a:lstStyle/><a:p><a:pPr lvl=\"0\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl=\"1\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl=\"2\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl=\"3\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl=\"4\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Fifth level</a:t></a:r><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr>\\r\\n'\r\n        + '<p:cNvPr id=\"4\" name=\"Date Placeholder 3\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"dt\" sz=\"half\" idx=\"2\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"457200\" y=\"6356350\"/><a:ext cx=\"2133600\" cy=\"365125\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"ctr\"/><a:lstStyle><a:lvl1pPr algn=\"l\"><a:defRPr sz=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:fld id=\"{F8166F1F-CE9B-4651-A6AA-CD717754106B}\" type=\"datetimeFigureOut\"><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>12/25/2015</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr>\\r\\n'\r\n        + '<p:cNvPr id=\"5\" name=\"Footer Placeholder 4\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"ftr\" sz=\"quarter\" idx=\"3\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"3124200\" y=\"6356350\"/><a:ext cx=\"2895600\" cy=\"365125\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"ctr\"/><a:lstStyle><a:lvl1pPr algn=\"ctr\"><a:defRPr sz=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr>\\r\\n'\r\n        + '<p:cNvPr id=\"6\" name=\"Slide Number Placeholder 5\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"sldNum\" sz=\"quarter\" idx=\"4\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"6553200\" y=\"6356350\"/><a:ext cx=\"2133600\" cy=\"365125\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"ctr\"/><a:lstStyle><a:lvl1pPr algn=\"r\"><a:defRPr sz=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:fld id=\"'+SLDNUMFLDID+'\" type=\"slidenum\"><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t></a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp></p:spTree></p:cSld><p:clrMap bg1=\"lt1\" tx1=\"dk1\" bg2=\"lt2\" tx2=\"dk2\" accent1=\"accent1\" accent2=\"accent2\" accent3=\"accent3\" accent4=\"accent4\" accent5=\"accent5\" accent6=\"accent6\" hlink=\"hlink\" folHlink=\"folHlink\"/>\\r\\n'\r\n        + '<p:sldLayoutIdLst>\\r\\n';\r\n  // Create a sldLayout for each SLIDE\r\n  for ( var idx=1; idx<=gObjPptx.slides.length; idx++ ) {\r\n    strXml += ' <p:sldLayoutId id=\"'+ intSlideLayoutId +'\" r:id=\"rId'+ idx +'\"/>\\r\\n';\r\n    intSlideLayoutId++;\r\n  }\r\n  strXml += '</p:sldLayoutIdLst>\\r\\n'\r\n        + '<p:txStyles>\\r\\n'\r\n        + ' <p:titleStyle>\\r\\n'\r\n        + '  <a:lvl1pPr algn=\"ctr\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"0\"/></a:spcBef><a:buNone/><a:defRPr sz=\"4400\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mj-lt\"/><a:ea typeface=\"+mj-ea\"/><a:cs typeface=\"+mj-cs\"/></a:defRPr></a:lvl1pPr>\\r\\n'\r\n        + ' </p:titleStyle>'\r\n        + ' <p:bodyStyle>\\r\\n'\r\n        + '  <a:lvl1pPr marL=\"342900\" indent=\"-342900\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"3200\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl1pPr>'\r\n        + '  <a:lvl2pPr marL=\"742950\" indent=\"-285750\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl2pPr>'\r\n        + '  <a:lvl3pPr marL=\"1143000\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2400\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl3pPr>'\r\n        + '  <a:lvl4pPr marL=\"1600200\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl4pPr>'\r\n        + '  <a:lvl5pPr marL=\"2057400\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl5pPr>'\r\n        + '  <a:lvl6pPr marL=\"2514600\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl6pPr>'\r\n        + '  <a:lvl7pPr marL=\"2971800\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl7pPr>'\r\n        + '  <a:lvl8pPr marL=\"3429000\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl8pPr>'\r\n        + '  <a:lvl9pPr marL=\"3886200\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl9pPr>'\r\n        + ' </p:bodyStyle>\\r\\n'\r\n        + ' <p:otherStyle>\\r\\n'\r\n        + '  <a:defPPr><a:defRPr lang=\"en-US\"/></a:defPPr>'\r\n        + '  <a:lvl1pPr marL=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl1pPr>'\r\n        + '  <a:lvl2pPr marL=\"457200\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl2pPr>'\r\n        + '  <a:lvl3pPr marL=\"914400\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl3pPr>'\r\n        + '  <a:lvl4pPr marL=\"1371600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl4pPr>'\r\n        + '  <a:lvl5pPr marL=\"1828800\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl5pPr>'\r\n        + '  <a:lvl6pPr marL=\"2286000\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl6pPr>'\r\n        + '  <a:lvl7pPr marL=\"2743200\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl7pPr>'\r\n        + '  <a:lvl8pPr marL=\"3200400\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl8pPr>'\r\n        + '  <a:lvl9pPr marL=\"3657600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl9pPr>'\r\n        + ' </p:otherStyle>\\r\\n'\r\n        + '</p:txStyles>\\r\\n'\r\n        + '</p:sldMaster>';\r\n  //\r\n  return strXml;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ppt/slideMasters/slideMasterXml.js","export default function makeXmlSlideMasterRel( gObjPptx ) {\r\n    // TODO 1.1: create a slideLayout for each SLDIE\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n' +\r\n        '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\\r\\n';\r\n    for ( var idx = 1; idx <= gObjPptx.slides.length; idx++ ) {\r\n        strXml += '  <Relationship Id=\"rId' + idx + '\" Target=\"../slideLayouts/slideLayout' + idx + '.xml\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout\"/>\\r\\n';\r\n    }\r\n    strXml += '  <Relationship Id=\"rId' + ( gObjPptx.slides.length + 1 ) + '\" Target=\"../theme/theme1.xml\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\"/>\\r\\n';\r\n    strXml += '</Relationships>';\r\n    //\r\n    return strXml;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ppt/slideMasters/slideMasterRelXml.js","export default function makeXmlTheme() {\r\n  var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n\\\r\n\t\t\t\t\t\t<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\">\\\r\n\t\t\t\t\t\t<a:themeElements>\\\r\n\t\t\t\t\t\t  <a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1>\\\r\n\t\t\t\t\t\t  <a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2>\\\r\n\t\t\t\t\t\t  <a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2><a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1><a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2><a:accent3>\\\r\n\t\t\t\t\t\t  <a:srgbClr val=\"9BBB59\"/></a:accent3><a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4><a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5>\\\r\n\t\t\t\t\t\t  <a:accent6><a:srgbClr val=\"F79646\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Arial\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"MS P????\"/><a:font script=\"Hang\" typeface=\"?? ??\"/><a:font script=\"Hans\" typeface=\"??\"/><a:font script=\"Hant\" typeface=\"????\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Angsana New\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/></a:majorFont><a:minorFont><a:latin typeface=\"Arial\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"MS P????\"/><a:font script=\"Hang\" typeface=\"?? ??\"/><a:font script=\"Hans\" typeface=\"??\"/><a:font script=\"Hant\" typeface=\"????\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Cordia New\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>\\\r\n\t\t\t\t\t\t  </a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"1\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:shade val=\"51000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"80000\"><a:schemeClr val=\"phClr\"><a:shade val=\"93000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"94000\"/><a:satMod val=\"135000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/>\\\r\n\t\t\t\t\t\t</a:theme>';\r\n  return strXml;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ppt/theme/themeXml.js","export default function makeXmlPresentation(gObjPptx) {\r\n  var intCurPos = 0;\r\n  var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n'\r\n        + '<p:presentation xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\" saveSubsetFonts=\"1\">\\r\\n';\r\n\r\n  // STEP 1: Build SLIDE master list\r\n  strXml += '<p:sldMasterIdLst><p:sldMasterId id=\"2147483648\" r:id=\"rId1\"/></p:sldMasterIdLst>\\r\\n';\r\n  strXml += '<p:sldIdLst>\\r\\n';\r\n  for ( var idx=0; idx<gObjPptx.slides.length; idx++ ) {\r\n    strXml += '<p:sldId id=\"' + (idx + 256) + '\" r:id=\"rId' + (idx + 2) + '\"/>\\r\\n';\r\n  }\r\n  strXml += '</p:sldIdLst>\\r\\n';\r\n\r\n  // STEP 2: Build SLIDE text styles\r\n  strXml += '<p:sldSz cx=\"'+ gObjPptx.pptLayout.width +'\" cy=\"'+ gObjPptx.pptLayout.height +'\" type=\"'+ gObjPptx.pptLayout.name +'\"/>\\r\\n'\r\n      + '<p:notesSz cx=\"'+ gObjPptx.pptLayout.height +'\" cy=\"' + gObjPptx.pptLayout.width + '\"/>'\r\n      + '<p:defaultTextStyle>';\r\n      + '  <a:defPPr><a:defRPr lang=\"en-US\"/></a:defPPr>';\r\n  for ( var idx=1; idx<10; idx++ ) {\r\n    strXml += '  <a:lvl' + idx + 'pPr marL=\"' + intCurPos + '\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\">'\r\n        + '    <a:defRPr sz=\"1800\" kern=\"1200\">'\r\n        + '      <a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill>'\r\n        + '      <a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/>'\r\n        + '    </a:defRPr>'\r\n        + '  </a:lvl' + idx + 'pPr>';\r\n    intCurPos += 457200;\r\n  }\r\n  strXml += '</p:defaultTextStyle>\\r\\n';\r\n\r\n  strXml += '<p:extLst><p:ext uri=\"{EFAFB233-063F-42B5-8137-9DF3F51BA10A}\"><p15:sldGuideLst xmlns:p15=\"http://schemas.microsoft.com/office/powerpoint/2012/main\"/></p:ext></p:extLst>\\r\\n'\r\n      + '</p:presentation>';\r\n  //\r\n  return strXml;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ppt/presentationXml.js","export default function makeXmlPresProps() {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n' +\r\n        '<p:presentationPr xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\">\\r\\n' +\r\n        '  <p:extLst>\\r\\n' +\r\n        '    <p:ext uri=\"{E76CE94A-603C-4142-B9EB-6D1370010A27}\"><p14:discardImageEditData xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"0\"/></p:ext>\\r\\n' +\r\n        '    <p:ext uri=\"{D31A062A-798A-4329-ABDD-BBA856620510}\"><p14:defaultImageDpi xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"220\"/></p:ext>\\r\\n' +\r\n        '    <p:ext uri=\"{FD5EFAAD-0ECE-453E-9831-46B23BE46B34}\"><p15:chartTrackingRefBased xmlns:p15=\"http://schemas.microsoft.com/office/powerpoint/2012/main\" val=\"1\"/></p:ext>\\r\\n' +\r\n        '  </p:extLst>\\r\\n' +\r\n        '</p:presentationPr>';\r\n    return strXml;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ppt/presPropsXml.js","export default function makeXmlTableStyles() {\r\n    // SEE: http://openxmldeveloper.org/discussions/formats/f/13/p/2398/8107.aspx\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n' +\r\n        '<a:tblStyleLst xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" def=\"{5C22544A-7EE6-4342-B048-85BDC9FD1C3A}\"/>';\r\n    return strXml;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ppt/tableStyleXml.js","export default function makeXmlViewProps() {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n' +\r\n        '<p:viewPr xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\">' +\r\n        '<p:normalViewPr><p:restoredLeft sz=\"15620\"/><p:restoredTop sz=\"94660\"/></p:normalViewPr>' +\r\n        '<p:slideViewPr>' +\r\n        '  <p:cSldViewPr>' +\r\n        '    <p:cViewPr varScale=\"1\"><p:scale><a:sx n=\"64\" d=\"100\"/><a:sy n=\"64\" d=\"100\"/></p:scale><p:origin x=\"-1392\" y=\"-96\"/></p:cViewPr>' +\r\n        '    <p:guideLst><p:guide orient=\"horz\" pos=\"2160\"/><p:guide pos=\"2880\"/></p:guideLst>' +\r\n        '  </p:cSldViewPr>' +\r\n        '</p:slideViewPr>' +\r\n        '<p:notesTextViewPr>' +\r\n        '  <p:cViewPr><p:scale><a:sx n=\"100\" d=\"100\"/><a:sy n=\"100\" d=\"100\"/></p:scale><p:origin x=\"0\" y=\"0\"/></p:cViewPr>' +\r\n        '</p:notesTextViewPr>' +\r\n        '<p:gridSpacing cx=\"78028800\" cy=\"78028800\"/>' +\r\n        '</p:viewPr>';\r\n    return strXml;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ppt/viewPropsXml.js","import ExportTable  from './utils/slideHelpers/exportTable';\r\nimport ExportImage  from './utils/slideHelpers/exportImage';\r\nimport OptionAdapter  from './utils/slideHelpers/optionAdapter';\r\nimport Group from './group/slideGroup';\r\nimport Slide from './slide';\r\nimport Shape from './shape/shape.js';\r\n\r\n\r\nexport default function makeXmlSlide(inSlide, gObjPptx) {\r\n\r\n    const EMU = 914400, ONEPT= 12700;\r\n    let intTableNum = 1,\r\n    objSlideData = inSlide.data,\r\n    strSlideXml;\r\n\r\n    if(inSlide.slide.group){\r\n        var startGroup, endGroup,\r\n        group = new Group(gObjPptx).generateGroup();\r\n\r\n        startGroup = group.groupStart;\r\n        endGroup = group.groupEnd;\r\n    }\r\n    // STEP 1: Start slide XML\r\n    strSlideXml = Slide.header(inSlide);\r\n    (inSlide.slide.group) ? strSlideXml += startGroup: strSlideXml;\r\n\r\n    // STEP 5: Loop over all Slide objects and add them to this slide:\r\n    $.each(objSlideData, function(idx, slideObj){\r\n\r\n        // A: Set option vars\r\n        if ( slideObj.options ) {\r\n            var { x, y, cx, cy, shapeType, locationAttr } = OptionAdapter(slideObj, gObjPptx)\r\n        }else{\r\n            var x = 0, y = 0, cx = (EMU*10), cy = 0,\r\n                locationAttr = '',\r\n                shapeType = null;\r\n        }\r\n\r\n        // B: Create this particular object on Slide\r\n        switch ( slideObj.type ) {\r\n            case 'table':\r\n                strSlideXml += ExportTable(inSlide, slideObj, intTableNum, x, y, cx, cy);\r\n                break;\r\n\r\n            case 'text':\r\n                strSlideXml += new Shape(slideObj).generateShape(idx, inSlide)\r\n                break;\r\n\r\n            case 'image':\r\n                strSlideXml += ExportImage(idx, slideObj, locationAttr, x , y, cx, cy)\r\n                break;\r\n        }\r\n    });\r\n    (inSlide.slide.group) ? strSlideXml += endGroup: strSlideXml;\r\n    // STEP 6: Close spTree and finalize slide XML\r\n    strSlideXml += Slide.footer();\r\n\r\n    // LAST: Return\r\n    return strSlideXml;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/ppt/slides/slideXml.js","import { inch2Emu, decodeXmlEntities, parseTextToLines } from '../helpers'\r\n\r\n\r\nexport default function ExportTable(inSlide, slideObj, intTableNum, x, y, cx, cy){\r\n\r\n    const ONEPT = 12700, EMU = 914400;\r\n    let arrRowspanCells = [],\r\n        arrTabRows = slideObj.arrTabRows,\r\n        objTabOpts = slideObj.objTabOpts,\r\n        intColCnt = 0,\r\n        intColW = 0;\r\n\r\n    // NOTE: Cells may have a colspan, so merely taking the length of the [0] (or any other) row is not\r\n    // ....: sufficient to determine column count. Therefore, check each cell for a colspan and total cols as reqd\r\n    for (var tmp=0; tmp<arrTabRows[0].length; tmp++) {\r\n        intColCnt += ( arrTabRows[0][tmp].opts && arrTabRows[0][tmp].opts.colspan ) ? Number(arrTabRows[0][tmp].opts.colspan) : 1;\r\n    }\r\n\r\n    // STEP 1: Start Table XML\r\n    // NOTE: Non-numeric cNvPr id values will trigger \"presentation needs repair\" type warning in MS-PPT-2013\r\n    var strXml = '<p:graphicFrame>'\r\n        + '  <p:nvGraphicFramePr>'\r\n        + '    <p:cNvPr id=\"'+ (intTableNum*inSlide.numb + 1) +'\" name=\"Table '+ (intTableNum*inSlide.numb) +'\"/>'\r\n        + '    <p:cNvGraphicFramePr><a:graphicFrameLocks noGrp=\"1\"/></p:cNvGraphicFramePr>'\r\n        + '    <p:nvPr><p:extLst><p:ext uri=\"{D42A27DB-BD31-4B8C-83A1-F6EECF244321}\"><p14:modId xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"1579011935\"/></p:ext></p:extLst></p:nvPr>'\r\n        + '  </p:nvGraphicFramePr>'\r\n        + '  <p:xfrm>'\r\n        + '    <a:off  x=\"'+ (x  || EMU) +'\"  y=\"'+ (y  || EMU) +'\"/>'\r\n        + '    <a:ext cx=\"'+ (cx || EMU) +'\" cy=\"'+ (cy || EMU) +'\"/>'\r\n        + '  </p:xfrm>'\r\n        + '  <a:graphic>'\r\n        + '    <a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/table\">'\r\n        + '      <a:tbl>'\r\n        + '        <a:tblPr/>';\r\n    // + '        <a:tblPr bandRow=\"1\"/>';\r\n    // TODO 1.5: Support banded rows, first/last row, etc.\r\n    // NOTE: Banding, etc. only shows when using a table style! (or set alt row color if banding)\r\n    // <a:tblPr firstCol=\"0\" firstRow=\"0\" lastCol=\"0\" lastRow=\"0\" bandCol=\"0\" bandRow=\"1\">\r\n\r\n    // STEP 2: Set column widths\r\n    // Evenly distribute cols/rows across size provided when applicable (calc them if only overall dimensions were provided)\r\n    // A: Col widths provided?\r\n    if ( Array.isArray(objTabOpts.colW) ) {\r\n        strXml += '<a:tblGrid>';\r\n        for ( var col=0; col<intColCnt; col++ ) {\r\n            strXml += '  <a:gridCol w=\"'+ (objTabOpts.colW[col] || (slideObj.options.cx/intColCnt)) +'\"/>';\r\n        }\r\n        strXml += '</a:tblGrid>';\r\n    }\r\n    // B: Table Width provided without colW? Then distribute cols\r\n    else {\r\n        intColW = (objTabOpts.colW) ? objTabOpts.colW : EMU;\r\n        if ( slideObj.options.cx && !objTabOpts.colW ) intColW = ( slideObj.options.cx / intColCnt );\r\n        strXml += '<a:tblGrid>';\r\n        for ( var col=0; col<intColCnt; col++ ) { strXml += '<a:gridCol w=\"'+ intColW +'\"/>'; }\r\n        strXml += '</a:tblGrid>';\r\n    }\r\n    // C: Table Height provided without rowH? Then distribute rows\r\n    var intRowH = (objTabOpts.rowH) ? inch2Emu(objTabOpts.rowH) : 0;\r\n    if ( slideObj.options.cy && !objTabOpts.rowH ) intRowH = ( slideObj.options.cy / arrTabRows.length );\r\n\r\n    // STEP 3: Build an array of rowspan cells now so we can add stubs in as we loop below\r\n    $.each(arrTabRows, (rIdx,row) => {\r\n        $(row).each(function(cIdx,cell){\r\n            var colIdx = cIdx;\r\n            if ( cell.opts && cell.opts.rowspan && Number.isInteger(cell.opts.rowspan) ) {\r\n                for (let idy=1; idy<cell.opts.rowspan; idy++) {\r\n                    arrRowspanCells.push( {row:(rIdx+idy), col:colIdx} );\r\n                    colIdx++; // For cases where we already have a rowspan in this row - we need to Increment to account for this extra cell!\r\n                }\r\n            }\r\n        });\r\n    });\r\n\r\n    // STEP 4: Build table rows/cells\r\n    $.each(arrTabRows, (rIdx,row) => {\r\n        if ( Array.isArray(objTabOpts.rowH) && objTabOpts.rowH[rIdx] ) intRowH = inch2Emu(objTabOpts.rowH[rIdx]);\r\n\r\n        // A: Start row\r\n        strXml += '<a:tr h=\"'+ intRowH +'\">';\r\n\r\n        // B: Loop over each CELL\r\n        $(row).each(function(cIdx,cell){\r\n            // 1: OPTIONS: Build/set cell options (blocked for code folding)\r\n            {\r\n                // 1: Load/Create options\r\n                var cellOpts = cell.opts || {};\r\n\r\n                // 2: Do Important/Override Opts\r\n                // Feature: TabOpts Default Values (tabOpts being used when cellOpts dont exist):\r\n                // SEE: http://officeopenxml.com/drwTableCellProperties-alignment.php\r\n                $.each(['align','bold','border','color','fill','font_face','font_size','underline','valign'], function(i,name){\r\n                    if ( objTabOpts[name] && ! cellOpts[name]) cellOpts[name] = objTabOpts[name];\r\n                });\r\n\r\n                var cellB       = (cellOpts.bold)       ? ' b=\"1\"' : ''; // [0,1] or [false,true]\r\n                var cellU       = (cellOpts.underline)  ? ' u=\"sng\"' : ''; // [none,sng (single), et al.]\r\n                var cellFont    = (cellOpts.font_face)  ? ' <a:latin typeface=\"'+ cellOpts.font_face +'\"/>' : '';\r\n                var cellFontPt  = (cellOpts.font_size)  ? ' sz=\"'+ cellOpts.font_size +'00\"' : '';\r\n                var cellAlign   = (cellOpts.align)      ? ' algn=\"'+ cellOpts.align.replace(/^c$/i,'ctr').replace('center','ctr').replace('left','l').replace('right','r') +'\"' : '';\r\n                var cellValign  = (cellOpts.valign)     ? ' anchor=\"'+ cellOpts.valign.replace(/^c$/i,'ctr').replace(/^m$/i,'ctr').replace('center','ctr').replace('middle','ctr').replace('top','t').replace('btm','b').replace('bottom','b') +'\"' : '';\r\n                var cellColspan = (cellOpts.colspan)    ? ' gridSpan=\"'+ cellOpts.colspan +'\"' : '';\r\n                var cellRowspan = (cellOpts.rowspan)    ? ' rowSpan=\"'+ cellOpts.rowspan +'\"' : '';\r\n                var cellFontClr = ((cell.optImp && cell.optImp.color) || cellOpts.color) ? ' <a:solidFill><a:srgbClr val=\"'+ ((cell.optImp && cell.optImp.color) || cellOpts.color) +'\"/></a:solidFill>' : '';\r\n                var cellFill    = ((cell.optImp && cell.optImp.fill)  || cellOpts.fill ) ? ' <a:solidFill><a:srgbClr val=\"'+ ((cell.optImp && cell.optImp.fill) || cellOpts.fill) +'\"/></a:solidFill>' : '';\r\n                var intMarginPt = (cellOpts.marginPt || cellOpts.marginPt == 0) ? (cellOpts.marginPt * ONEPT) : 0;\r\n                // Margin/Padding:\r\n                var cellMargin  = '';\r\n                if ( cellOpts.marginPt && Array.isArray(cellOpts.marginPt) ) {\r\n                    cellMargin = ' marL=\"'+ cellOpts.marginPt[3] +'\" marR=\"'+ cellOpts.marginPt[1] +'\" marT=\"'+ cellOpts.marginPt[0] +'\" marB=\"'+ cellOpts.marginPt[2] +'\"';\r\n                }\r\n                else if ( cellOpts.marginPt && Number.isInteger(cellOpts.marginPt) ) {\r\n                    cellMargin = ' marL=\"'+ intMarginPt +'\" marR=\"'+ intMarginPt +'\" marT=\"'+ intMarginPt +'\" marB=\"'+ intMarginPt +'\"';\r\n                }\r\n            }\r\n\r\n            // 2: Cell Content: Either the text element or the cell itself (for when users just pass a string - no object or options)\r\n            var strCellText = ((typeof cell === 'object') ? cell.text : cell);\r\n\r\n            // TODO 1.5: Cell NOWRAP property (text wrap: add to a:tcPr (horzOverflow=\"overflow\" or whatev opts exist)\r\n\r\n            // 3: ROWSPAN: Add dummy cells for any active rowspan\r\n            // TODO 1.5: ROWSPAN & COLSPAN in same cell is not yet handled!\r\n            if ( arrRowspanCells.filter(function(obj){ return obj.row == rIdx && obj.col == cIdx }).length > 0 ) {\r\n                strXml += '<a:tc vMerge=\"1\"><a:tcPr/></a:tc>';\r\n            }\r\n\r\n            // 4: Start Table Cell, add Align, add Text content\r\n            strXml += ' <a:tc'+ cellColspan + cellRowspan +'>'\r\n                + '  <a:txBody>'\r\n                + '    <a:bodyPr/>'\r\n                + '    <a:lstStyle/>'\r\n                + '    <a:p>'\r\n                + '      <a:pPr'+ cellAlign +'/>'\r\n                + '      <a:r>'\r\n                + '        <a:rPr lang=\"en-US\" dirty=\"0\" smtClean=\"0\"'+ cellFontPt + cellB + cellU +'>'+ cellFontClr + cellFont +'</a:rPr>'\r\n                + '        <a:t>'+ decodeXmlEntities(strCellText) +'</a:t>'\r\n                + '      </a:r>'\r\n                + '      <a:endParaRPr lang=\"en-US\" dirty=\"0\"/>'\r\n                + '    </a:p>'\r\n                + '  </a:txBody>'\r\n                + '  <a:tcPr'+ cellMargin + cellValign +'>';\r\n\r\n            // 5: Borders: Add any borders\r\n            if ( cellOpts.border && typeof cellOpts.border === 'string' ) {\r\n                strXml += '  <a:lnL w=\"'+ ONEPT +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:srgbClr val=\"'+ cellOpts.border +'\"/></a:solidFill></a:lnL>';\r\n                strXml += '  <a:lnR w=\"'+ ONEPT +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:srgbClr val=\"'+ cellOpts.border +'\"/></a:solidFill></a:lnR>';\r\n                strXml += '  <a:lnT w=\"'+ ONEPT +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:srgbClr val=\"'+ cellOpts.border +'\"/></a:solidFill></a:lnT>';\r\n                strXml += '  <a:lnB w=\"'+ ONEPT +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:srgbClr val=\"'+ cellOpts.border +'\"/></a:solidFill></a:lnB>';\r\n            }\r\n            else if ( cellOpts.border && Array.isArray(cellOpts.border) ) {\r\n                $.each([ {idx:3,name:'lnL'}, {idx:1,name:'lnR'}, {idx:0,name:'lnT'}, {idx:2,name:'lnB'} ], function(i,obj){\r\n                    if ( cellOpts.border[obj.idx] ) {\r\n                        var strC = '<a:solidFill><a:srgbClr val=\"'+ ((cellOpts.border[obj.idx].color) ? cellOpts.border[obj.idx].color : '666666') +'\"/></a:solidFill>';\r\n                        var intW = (cellOpts.border[obj.idx] && (cellOpts.border[obj.idx].pt || cellOpts.border[obj.idx].pt == 0)) ? (ONEPT * Number(cellOpts.border[obj.idx].pt)) : ONEPT;\r\n                        strXml += '<a:'+ obj.name +' w=\"'+ intW +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">'+ strC +'</a:'+ obj.name +'>';\r\n                    }\r\n                    else strXml += '<a:'+ obj.name +' w=\"0\"><a:miter lim=\"400000\" /></a:'+ obj.name +'>';\r\n                });\r\n            }\r\n            else if ( cellOpts.border && typeof cellOpts.border === 'object' ) {\r\n                var intW = (cellOpts.border && (cellOpts.border.pt || cellOpts.border.pt == 0) ) ? (ONEPT * Number(cellOpts.border.pt)) : ONEPT;\r\n                var strClr = '<a:solidFill><a:srgbClr val=\"'+ ((cellOpts.border.color) ? cellOpts.border.color : '666666') +'\"/></a:solidFill>';\r\n                var strAttr = '<a:prstDash val=\"';\r\n                strAttr += ((cellOpts.border.type && cellOpts.border.type.toLowerCase().indexOf('dash') > -1) ? \"sysDash\" : \"solid\" );\r\n                strAttr += '\"/><a:round/><a:headEnd type=\"none\" w=\"med\" len=\"med\"/><a:tailEnd type=\"none\" w=\"med\" len=\"med\"/>';\r\n                // *** IMPORTANT! *** LRTB order matters! (Reorder a line below to watch the borders go wonky in MS-PPT-2013!!)\r\n                strXml += '<a:lnL w=\"'+ intW +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">'+ strClr + strAttr +'</a:lnL>';\r\n                strXml += '<a:lnR w=\"'+ intW +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">'+ strClr + strAttr +'</a:lnR>';\r\n                strXml += '<a:lnT w=\"'+ intW +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">'+ strClr + strAttr +'</a:lnT>';\r\n                strXml += '<a:lnB w=\"'+ intW +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">'+ strClr + strAttr +'</a:lnB>';\r\n                // *** IMPORTANT! *** LRTB order matters!\r\n            }\r\n\r\n            // 6: Close cell Properties & Cell\r\n            strXml += cellFill\r\n                + '  </a:tcPr>'\r\n                + ' </a:tc>';\r\n\r\n            // LAST: COLSPAN: Add a 'merged' col for each column being merged (SEE: http://officeopenxml.com/drwTableGrid.php)\r\n            if ( cellOpts.colspan ) {\r\n                for (var tmp=1; tmp<Number(cellOpts.colspan); tmp++) { strXml += '<a:tc hMerge=\"1\"><a:tcPr/></a:tc>'; }\r\n            }\r\n        });\r\n\r\n        // B-2: Handle Rowspan as last col case\r\n        // We add dummy cells inside cell loop, but cases where last col is rowspaned\r\n        // by prev row wont be created b/c cell loop above exhausted before the col\r\n        // index of the final col was reached... ANYHOO, add it here when necc.\r\n        if ( arrRowspanCells.filter(function(obj){ return obj.row == rIdx && (obj.col+1) >= $(row).length }).length > 0 ) {\r\n            strXml += '<a:tc vMerge=\"1\"><a:tcPr/></a:tc>';\r\n        }\r\n\r\n        // C: Complete row\r\n        strXml += '</a:tr>';\r\n    });\r\n\r\n    // STEP 5: Complete table\r\n    strXml += '      </a:tbl>'\r\n        + '    </a:graphicData>'\r\n        + '  </a:graphic>'\r\n        + '</p:graphicFrame>';\r\n\r\n    // STEP 6: Set table XML\r\n    let strSlideXml = strXml;\r\n\r\n    // LAST: Increment counter\r\n    intTableNum++;\r\n\r\n    return strSlideXml;\r\n\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ppt/slides/utils/slideHelpers/exportTable.js","export default function (idx, slideObj, locationAttr, x , y, cx, cy) {\r\n\r\n    let strSlideXml = `<p:pic>\r\n                        <p:nvPicPr>\r\n                          <p:cNvPr id=\"${(idx + 2)}\" name=\"Object ${(idx + 1)}\" descr=\"${slideObj.image}\"/>\r\n                                <p:cNvPicPr>\r\n                                    <a:picLocks noChangeAspect=\"1\"/></p:cNvPicPr><p:nvPr/>\r\n                                </p:nvPicPr>\r\n                                <p:blipFill>\r\n                                    <a:blip r:embed=\"rId${slideObj.imageRid}\" cstate=\"print\"/><a:stretch><a:fillRect/></a:stretch>\r\n                                </p:blipFill>\r\n                            <p:spPr>\r\n                                <a:xfrm${locationAttr}>\r\n                                    <a:off  x=\"${x}\"  y=\"${y}\"/>\r\n                                    <a:ext cx=\"${cx}\" cy=\"${cy}\"/>\r\n                                </a:xfrm>\r\n                                <a:prstGeom prst=\"rect\">\r\n                                    <a:avLst/>\r\n                                </a:prstGeom>\r\n                            </p:spPr>\r\n                    </p:pic>`;\r\n\r\n    return strSlideXml;\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ppt/slides/utils/slideHelpers/exportImage.js","import { getShapeInfo, getSmartParseNumber } from '../helpers';\r\n\r\nexport default function(slideObj, gObjPptx){\r\n    const EMU = 914400;\r\n    let x = 0, y = 0, cx = (EMU*10), cy = 0,\r\n        locationAttr = '',\r\n        shapeType = null;\r\n\r\n    if ( slideObj.options.w  || slideObj.options.w  == 0 ) slideObj.options.cx = slideObj.options.w;\r\n    if ( slideObj.options.h  || slideObj.options.h  == 0 ) slideObj.options.cy = slideObj.options.h;\r\n    //\r\n    if ( slideObj.options.x  || slideObj.options.x  == 0 )  x = getSmartParseNumber( slideObj.options.x , 'X', gObjPptx );\r\n    if ( slideObj.options.y  || slideObj.options.y  == 0 )  y = getSmartParseNumber( slideObj.options.y , 'Y', gObjPptx );\r\n    if ( slideObj.options.cx || slideObj.options.cx == 0 ) cx = getSmartParseNumber( slideObj.options.cx, 'X', gObjPptx );\r\n    if ( slideObj.options.cy || slideObj.options.cy == 0 ) cy = getSmartParseNumber( slideObj.options.cy, 'Y', gObjPptx );\r\n    if ( slideObj.options.flipH  ) locationAttr += ' flipH=\"1\"';\r\n    if ( slideObj.options.flipV  ) locationAttr += ' flipV=\"1\"';\r\n    if ( slideObj.options.shape  ) shapeType = getShapeInfo( slideObj.options.shape );\r\n    if ( slideObj.options.rotate ) {\r\n        let rotateVal = (slideObj.options.rotate > 360) ? (slideObj.options.rotate - 360) : slideObj.options.rotate;\r\n        rotateVal *= 60000;\r\n        locationAttr += ` rot=\"${rotateVal}\"`;\r\n    }\r\n    return {x, y,cx,cy,shapeType,locationAttr}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/ppt/slides/utils/slideHelpers/optionAdapter.js","import BaseGroup from './baseGroup';\r\nimport { inch2Emu } from '../utils/helpers';\r\n\r\nexport default class SlideGroup extends BaseGroup {\r\n    constructor(gObjPptx) {\r\n        super();\r\n        this.allShapes = gObjPptx.slides;\r\n    }\r\n\r\n    set groupStart(sGroupStart){\r\n      this._groupStart = sGroupStart;\r\n    }\r\n\r\n    get groupStart(){\r\n      return this._groupStart;\r\n    }\r\n\r\n    set groupEnd(sGroupEnd){\r\n      this._groupEnd = sGroupEnd;\r\n    }\r\n\r\n    get groupEnd(){\r\n      return this._groupEnd;\r\n    }\r\n\r\n    generateGroup() {\r\n      let nLength = this.allShapes.length, nIndex;\r\n\r\n      for (nIndex=0; nIndex < nLength; nIndex++){\r\n          let oShapes = this.allShapes[nIndex].data,\r\n              groupIndex=0;\r\n\r\n          for(let j=0; j< oShapes.length; j++){\r\n              let oShape = oShapes[j].options;\r\n              Object.keys(this.wrapperGroupCoordinate).map((i) => {\r\n                  let nValue;\r\n                  if (i === 'name'){\r\n                      this.wrapperGroupCoordinate[i] = this.allShapes[nIndex].name;\r\n                  }\r\n                  // get the x,y of the first shape\r\n                  else if (i === 'x' || i === 'y'){\r\n                      if (groupIndex < 2){\r\n                          this.wrapperGroupCoordinate[i] =  oShape[i];\r\n                          groupIndex++;\r\n                      } else {\r\n                          // if an unordred shapes\r\n                          this.wrapperGroupCoordinate[i] =  Math.min(this.wrapperGroupCoordinate[i] , oShape[i])\r\n                      }\r\n                  }\r\n                  else if (i === 'cx' && (oShape[i] || oShape['w'])){\r\n                      nValue =  oShape[i]? oShape[i]: oShape['w'];\r\n\r\n                      if (groupIndex === 2){\r\n                          this.wrapperGroupCoordinate[i] = nValue;\r\n                          groupIndex++;\r\n                      }\r\n\r\n                      if (oShape['x'] > (this.wrapperGroupCoordinate[i] + this.wrapperGroupCoordinate['x']) ){\r\n                          this.wrapperGroupCoordinate[i] = oShape['x'] + nValue;\r\n                      }\r\n                  }\r\n                  else if(i === 'cy' && (oShape[i] || oShape['h'])){\r\n                      nValue = oShape[i]? oShape[i]: oShape['h'];\r\n\r\n                      if (groupIndex === 3){\r\n                          this.wrapperGroupCoordinate[i] = nValue;\r\n                          groupIndex++;\r\n                      }\r\n                      if ( oShape['y'] > ( this.wrapperGroupCoordinate[i] + this.wrapperGroupCoordinate['y']) ){\r\n                          this.wrapperGroupCoordinate[i] = oShape['y'] + nValue;\r\n                      }\r\n                  }\r\n              })\r\n          }\r\n      }\r\n      let sStart = [\r\n          `<p:grpSp>`,\r\n          ` <p:nvGrpSpPr>`,\r\n          ` <p:cNvPr id=\"${this.wrapperGroupCoordinate.id}\" name=\"${this.wrapperGroupCoordinate.name}\"/>`,\r\n          `<p:cNvGrpSpPr/>`,\r\n          `<p:nvPr/>`,\r\n          `</p:nvGrpSpPr>`,\r\n          `<p:grpSpPr>`,\r\n          `<a:xfrm>`,\r\n          `<a:off x=\"${inch2Emu(this.wrapperGroupCoordinate.x)}\"  y=\"${inch2Emu(this.wrapperGroupCoordinate.y)}\"/>`,\r\n          `<a:ext cx=\"${inch2Emu(this.wrapperGroupCoordinate.cx)}\" cy=\"${inch2Emu(this.wrapperGroupCoordinate.cy)}\"/>`,\r\n          `<a:chOff x=\"${inch2Emu(this.wrapperGroupCoordinate.x)}\"  y=\"${inch2Emu(this.wrapperGroupCoordinate.y)}\" />`,\r\n          `<a:chExt cx=\"${inch2Emu(this.wrapperGroupCoordinate.cx)}\" cy=\"${inch2Emu(this.wrapperGroupCoordinate.cy)}\"/>`,\r\n          `</a:xfrm>`,\r\n          `</p:grpSpPr>`\r\n      ];\r\n        this.groupStart = sStart.join('')\r\n        this.groupEnd = '</p:grpSp>';\r\n        this.id++;\r\n        return this;\r\n    }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ppt/slides/group/slideGroup.js","export default class BaseGroup {\r\n\r\n    constructor( name ) {\r\n        this.id = 2;\r\n        this.wrapperGroupCoordinate = {id: this.id, name, x: 0, y: 0, cx: 0, cy: 0};\r\n        this.groupStart = '';\r\n        this.groupEnd = '';\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ppt/slides/group/baseGroup.js","import { getShapeInfo, genXmlColorSelection, genXmlTextCommand, genXmlBodyProperties } from '../utils/helpers';\r\nimport OptionAdapter from '../utils/slideHelpers/optionAdapter.js';\r\nimport Slide from '../slide.js';\r\n\r\nconst ONEPT = 12700, EMU = 914400;\r\n\r\nexport default class Shape {\r\n\r\n    constructor(shapeObject) {\r\n\r\n        this.shapeObject = shapeObject;\r\n        this.coordinate = OptionAdapter(this.shapeObject, Slide.gObjPptx)\r\n    }\r\n\r\n    fixMargin() {\r\n        // Lines can have zero cy, but text should not\r\n        let {cy} = this.coordinate;\r\n        if (!this.shapeObject.options.line && cy == 0) cy = (EMU * 0.3);\r\n\r\n        // Margin/Padding/Inset for textboxes\r\n        if (this.shapeObject.options.margin && Array.isArray(this.shapeObject.options.margin)) {\r\n\r\n            this.shapeObject.options.bodyProp.lIns = (this.shapeObject.options.margin[0] * ONEPT || 0);\r\n            this.shapeObject.options.bodyProp.rIns = (this.shapeObject.options.margin[1] * ONEPT || 0);\r\n            this.shapeObject.options.bodyProp.bIns = (this.shapeObject.options.margin[2] * ONEPT || 0);\r\n            this.shapeObject.options.bodyProp.tIns = (this.shapeObject.options.margin[3] * ONEPT || 0);\r\n        } else if ((this.shapeObject.options.margin || this.shapeObject.options.margin == 0) && Number.isInteger(this.shapeObject.options.margin)) {\r\n            this.shapeObject.options.bodyProp.lIns = (this.shapeObject.options.margin * ONEPT);\r\n            this.shapeObject.options.bodyProp.rIns = (this.shapeObject.options.margin * ONEPT);\r\n            this.shapeObject.options.bodyProp.bIns = (this.shapeObject.options.margin * ONEPT);\r\n            this.shapeObject.options.bodyProp.tIns = (this.shapeObject.options.margin * ONEPT);\r\n        }\r\n        return this; //.shapeObject;\r\n    }\r\n\r\n    setShapeProperty(idx) {\r\n\r\n        let isTextBox = this.shapeObject.options && this.shapeObject.options.isTextBox,\r\n            {x, y, cx, cy, locationAttr} = this.coordinate;\r\n\r\n        //B: The addition of the \"txBox\" attribute is the sole determiner of if an object is a Shape or Textbox\r\n        let aStr;\r\n        aStr = [\r\n            `<p:sp>`,\r\n            `<p:nvSpPr><p:cNvPr id=\"${(idx + 2)}\" name=\"Object ${(idx + 1)}\"/>`,\r\n            `<p:cNvSpPr ${(isTextBox) ? ' txBox=\"1\"/><p:nvPr/>' : '/><p:nvPr/>'}`,\r\n            `</p:nvSpPr>`,\r\n            `<p:spPr><a:xfrm${locationAttr}>`,\r\n            `<a:off x=\"${x}\" y=\"${y}\"/>`,\r\n            `<a:ext cx=\"${cx}\" cy=\"${cy}\"/></a:xfrm>`];\r\n\r\n        this._xmlShape = aStr.join('');\r\n        return this;\r\n    }\r\n\r\n\r\n    setPrstGeom() {\r\n\r\n        let { shapeType } = this.coordinate;\r\n\r\n        if (shapeType == null) shapeType = getShapeInfo(null);\r\n        if (this.shapeObject.options && this.shapeObject.options.customPreset) {\r\n            this._xmlShape += `<a:prstGeom prst=\"${shapeType.name}\">${this.shapeObject.options.customPreset}</a:prstGeom>`;\r\n        } else {\r\n            this._xmlShape += `<a:prstGeom prst=\"${shapeType.name}\"><a:avLst/></a:prstGeom>`;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    isFillOption() {\r\n        if (this.shapeObject.options) {\r\n\r\n            (this.shapeObject.options.fill) ? this._xmlShape += genXmlColorSelection(this.shapeObject.options.fill) : this._xmlShape += '<a:noFill/>';\r\n\r\n            if (this.shapeObject.options.line) {\r\n                var lineAttr = '';\r\n\r\n                if (this.shapeObject.options.line_size) lineAttr += ` w=\"${(this.shapeObject.options.line_size * ONEPT)}\"`;\r\n                this._xmlShape += `<a:ln${lineAttr}>`;\r\n                this._xmlShape += genXmlColorSelection(this.shapeObject.options.line);\r\n                if (this.shapeObject.options.line_head) this._xmlShape += `<a:headEnd type=\"${this.shapeObject.options.line_head}\"/>`;\r\n                if (this.shapeObject.options.line_tail) this._xmlShape += `<a:tailEnd type=\"${this.shapeObject.options.line_tail}\"/>`;\r\n                this._xmlShape += '</a:ln>';\r\n            }\r\n        } else {\r\n            this._xmlShape += '<a:noFill/>';\r\n        }\r\n        return this;\r\n    }\r\n\r\n    isEffect() {\r\n        if (this.shapeObject.options.effects) {\r\n\r\n            for (var ii = 0, total_size_ii = this.shapeObject.options.effects.length; ii < total_size_ii; ii++) {\r\n                switch (this.shapeObject.options.effects[ii].type) {\r\n\r\n                    case 'outerShadow':\r\n                        effectsList += cbGenerateEffects(this.shapeObject.options.effects[ii], 'outerShdw');\r\n                        break;\r\n                    case 'innerShadow':\r\n                        effectsList += cbGenerateEffects(this.shapeObject.options.effects[ii], 'innerShdw');\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    closeShapeProperty() {\r\n        this._xmlShape += '</p:spPr>';\r\n        return this;\r\n    }\r\n\r\n    styleProperty() {\r\n\r\n        let moreStyles = '',\r\n            moreStylesAttr = '',\r\n            outStyles = '',\r\n            styleData = '';\r\n\r\n        if (this.shapeObject.options) {\r\n\r\n            if (this.shapeObject.options.align) {\r\n                switch (this.shapeObject.options.align) {\r\n                    case 'right':\r\n                        moreStylesAttr += ' algn=\"r\"';\r\n                        break;\r\n                    case 'center':\r\n                        moreStylesAttr += ' algn=\"ctr\"';\r\n                        break;\r\n                    case 'justify':\r\n                        moreStylesAttr += ' algn=\"just\"';\r\n                        break;\r\n                }\r\n            }\r\n\r\n            if (this.shapeObject.options.indentLevel > 0) {\r\n                moreStylesAttr += ` lvl=\"${this.shapeObject.options.indentLevel}\"`;\r\n            }\r\n        }\r\n\r\n        if (moreStyles != '') this._xmlShape += `<a:pPr${moreStylesAttr}>${moreStyles}</a:pPr>`;\r\n        else if (moreStylesAttr != '') this._xmlShape += `<a:pPr${moreStylesAttr}/>`;\r\n\r\n        if (styleData != '') this._xmlShape += `<p:style>${styleData}</p:style>`;\r\n\r\n        return outStyles;\r\n    }\r\n\r\n    txBody(inSlide) {\r\n\r\n        if (typeof this.shapeObject.text == 'string') {\r\n\r\n            this._xmlShape += '<p:txBody>' + genXmlBodyProperties(this.shapeObject.options) + '<a:lstStyle/><a:p>' + this.styleProperty();\r\n            this._xmlShape += genXmlTextCommand(this.shapeObject.options, this.shapeObject.text, inSlide.slide, inSlide.slide.getPageNumber());\r\n\r\n        } else if (typeof this.shapeObject.text == 'number') {\r\n\r\n            this._xmlShape += '<p:txBody>' + genXmlBodyProperties(this.shapeObject.options) + '<a:lstStyle/><a:p>' + this.styleProperty();\r\n            this._xmlShape += genXmlTextCommand(this.shapeObject.options, this.shapeObject.text + '', inSlide.slide, inSlide.slide.getPageNumber());\r\n\r\n        } else if (this.shapeObject.text && this.shapeObject.text.length) {\r\n            var outBodyOpt = genXmlBodyProperties(this.shapeObject.options);\r\n            this._xmlShape += '<p:txBody>' + outBodyOpt + '<a:lstStyle/><a:p>' + this.styleProperty();\r\n\r\n            for (var j = 0, total_size_j = this.shapeObject.text.length; j < total_size_j; j++) {\r\n                if ((typeof this.shapeObject.text[j] == 'object') && this.shapeObject.text[j].text) {\r\n                    this._xmlShape += genXmlTextCommand(this.shapeObject.text[j].options || this.shapeObject.options, this.shapeObject.text[j].text, inSlide.slide, outBodyOpt, this.styleProperty(), inSlide.slide.getPageNumber());\r\n                } else if (typeof this.shapeObject.text[j] == 'string') {\r\n                    this._xmlShape += genXmlTextCommand(this.shapeObject.options, this.shapeObject.text[j], inSlide.slide, outBodyOpt, this.styleProperty(), inSlide.slide.getPageNumber());\r\n                } else if (typeof this.shapeObject.text[j] == 'number') {\r\n                    this._xmlShape += genXmlTextCommand(this.shapeObject.options, this.shapeObject.text[j] + '', inSlide.slide, outBodyOpt, this.styleProperty(), inSlide.slide.getPageNumber());\r\n                } else if ((typeof this.shapeObject.text[j] == 'object') && this.shapeObject.text[j].field) {\r\n                    this._xmlShape += genXmlTextCommand(this.shapeObject.options, this.shapeObject.text[j], inSlide.slide, outBodyOpt, this.styleProperty(), inSlide.slide.getPageNumber());\r\n                }\r\n            }\r\n        } else if ((typeof this.shapeObject.text == 'object') && this.shapeObject.text.field) {\r\n            this._xmlShape += '<p:txBody>' + genXmlBodyProperties(this.shapeObject.options) + '<a:lstStyle/><a:p>' + this.styleProperty();\r\n            this._xmlShape += genXmlTextCommand(this.shapeObject.options, this.shapeObject.text, inSlide.slide, inSlide.slide.getPageNumber());\r\n        }\r\n\r\n        // We must add that at the end of every paragraph with text:\r\n        if (typeof this.shapeObject.text !== 'undefined') {\r\n            var font_size = '';\r\n            if (this.shapeObject.options && this.shapeObject.options.font_size) font_size = ` sz=\"${this.shapeObject.options.font_size}00\"`;\r\n            this._xmlShape += `<a:endParaRPr lang=\"en-US\"${font_size} dirty=\"0\"/></a:p></p:txBody>`;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    closeShape(){\r\n        let sEndShape;\r\n        (this.shapeObject.type == 'cxn') ? sEndShape ='</p:cxnSp>' : sEndShape = '</p:sp>';\r\n        this._xmlShape += sEndShape;\r\n        return this;\r\n    }\r\n\r\n    generateShape(idx, inSlide){\r\n        this.fixMargin()\r\n            .setShapeProperty(idx)\r\n            .setPrstGeom()\r\n            .isFillOption()\r\n            .isEffect()\r\n            .closeShapeProperty()\r\n            .txBody(inSlide)\r\n            .closeShape();\r\n        return this._xmlShape;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/ppt/slides/shape/shape.js","export default function makeXmlSlideRel(inSlideNum, gObjPptx) {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n'\r\n        + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\\r\\n'\r\n        + '  <Relationship Id=\"rId1\" Target=\"../slideLayouts/slideLayout'+ inSlideNum +'.xml\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout\"/>\\r\\n';\r\n\r\n    // Add any IMAGEs for this Slide\r\n    for ( var idx=0; idx<gObjPptx.slides[inSlideNum-1].rels.length; idx++ ) {\r\n        strXml += '  <Relationship Id=\"rId'+ gObjPptx.slides[inSlideNum-1].rels[idx].rId +'\" Target=\"'+ gObjPptx.slides[inSlideNum-1].rels[idx].Target +'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\"/>\\r\\n';\r\n    }\r\n\r\n    strXml += '</Relationships>';\r\n    //\r\n    return strXml;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/ppt/slides/_rel/slideXmlRel.js","import { inch2Emu, rgbToHex, parseTextToLines } from '../utils/helpers'\r\nimport Slide from '../slide.js'\r\n\r\nconst ONEPT= 12700, EMU=914400;\r\n\r\nexport default class SlideTable {\r\n\r\n    addSlidesForTable( tabEleId, inOpts ) {\r\n\r\n        let opts = inOpts || {},\r\n            arrObjTabHeadRows = [],\r\n            arrObjTabBodyRows = [],\r\n            arrObjTabFootRows = [],\r\n            arrObjSlides = [],\r\n            arrRows = [],\r\n            arrColW = [],\r\n            arrTabColW = [],\r\n            intTabW = 0,\r\n            emuTabCurrH = 0;\r\n\r\n        // NOTE: Look for opts.margin first as user can override Slide Master settings if they want\r\n        let arrInchMargins = this.lookMargin(opts);\r\n\r\n        let emuSlideTabW = ( Slide.gObjPptx.pptLayout.width - inch2Emu( arrInchMargins[ 1 ] + arrInchMargins[ 3 ] ) );\r\n\r\n        let emuSlideTabH = ( Slide.gObjPptx.pptLayout.height - inch2Emu( arrInchMargins[ 0 ] + arrInchMargins[ 2 ] ) );\r\n\r\n        // STEP 1: Grab overall table style/col widths\r\n        this.tableStyle(tabEleId, arrTabColW);\r\n        $.each( arrTabColW, function( i, colW ) {\r\n            intTabW += colW;\r\n        } );\r\n\r\n        // STEP 2: Calc/Set column widths by using same column width percent from HTML table\r\n        this.calcColWidth(arrTabColW, tabEleId, arrColW, emuSlideTabW, intTabW);\r\n\r\n        // STEP 3: Iterate over each table element and create data arrays (text and opts)\r\n        // NOTE: We create 3 arrays instead of one so we can loop over body then show header/footer rows on first and last page\r\n        this.createDataArray(tabEleId, arrObjTabHeadRows, arrObjTabBodyRows, arrObjTabFootRows);\r\n\r\n        // STEP 4: Paginate data: Iterate over all table rows, divide into slides/pages based upon the row height>overall height\r\n        this.paginateData(arrObjTabHeadRows, arrObjTabBodyRows, arrObjTabFootRows, arrColW, emuTabCurrH, emuSlideTabH, arrRows, arrObjSlides, opts); // tab loop\r\n        // Flush final row buffer to slide\r\n        arrObjSlides.push( $.extend( true, [], arrRows ) );\r\n\r\n        // STEP 5: Create a SLIDE for each of our 1-N table pieces\r\n        this.createSlides(arrObjSlides, opts, arrInchMargins, emuSlideTabW, arrColW);\r\n    }\r\n\r\n    tableStyle(tabEleId, arrTabColW) {\r\n        $.each(['thead', 'tbody', 'tfoot'], (i, val) => {\r\n            if ($('#' + tabEleId + ' ' + val + ' tr').length > 0) {\r\n                $('#' + tabEleId + ' ' + val + ' tr:first-child').find('th, td').each(function (i, cell) {\r\n                    // TODO 1.5: This is a hack - guessing at col widths when colspan\r\n                    if ($(this).attr('colspan')) {\r\n                        for (var idx = 0; idx < $(this).attr('colspan'); idx++) {\r\n                            arrTabColW.push(Math.round($(this).outerWidth() / $(this).attr('colspan')));\r\n                        }\r\n                    } else {\r\n                        arrTabColW.push($(this).outerWidth());\r\n                    }\r\n                });\r\n                return false; // break out of .each loop\r\n            }\r\n        });\r\n    }\r\n    calcColWidth(arrTabColW, tabEleId, arrColW, emuSlideTabW, intTabW) {\r\n        $.each(arrTabColW, function (i, colW) {\r\n            ( $('#' + tabEleId + ' thead tr:first-child th:nth-child(' + ( i + 1 ) + ')').data('pptx-min-width') ) ?\r\n                arrColW.push(inch2Emu($('#' + tabEleId + ' thead tr:first-child th:nth-child(' + ( i + 1 ) + ')').data('pptx-min-width'))) : arrColW.push(Math.round(( emuSlideTabW * ( colW / intTabW * 100 ) ) / 100));\r\n        });\r\n    }\r\n    createDataArray(tabEleId, arrObjTabHeadRows, arrObjTabBodyRows, arrObjTabFootRows) {\r\n        $.each(['thead', 'tbody', 'tfoot'], function (i, val) {\r\n            $('#' + tabEleId + ' ' + val + ' tr').each(function (i, row) {\r\n                var arrObjTabCells = [];\r\n                $(row).find('th, td').each(function (i, cell) {\r\n                    // A: Covert colors to Hex from RGB\r\n                    var arrRGB1 = [];\r\n                    var arrRGB2 = [];\r\n                    arrRGB1 = $(cell).css('color').replace(/\\s+/gi, '').replace('rgb(', '').replace(')', '').split(',');\r\n                    arrRGB2 = $(cell).css('background-color').replace(/\\s+/gi, '').replace('rgb(', '').replace(')', '').split(',');\r\n\r\n                    // B: Create option object\r\n                    var objOpts = {\r\n                        font_size: $(cell).css('font-size').replace(/\\D/gi, ''),\r\n                        bold: ( ( $(cell).css('font-weight') == \"bold\" || Number($(cell).css('font-weight')) >= 500 ) ? true : false ),\r\n                        color: rgbToHex(Number(arrRGB1[0]), Number(arrRGB1[1]), Number(arrRGB1[2])),\r\n                        fill: rgbToHex(Number(arrRGB2[0]), Number(arrRGB2[1]), Number(arrRGB2[2]))\r\n                    };\r\n                    if ($.inArray($(cell).css('text-align'), ['left', 'center', 'right', 'start', 'end']) > -1) objOpts.align = $(cell).css('text-align').replace('start', 'left').replace('end', 'right');\r\n                    if ($.inArray($(cell).css('vertical-align'), ['top', 'middle', 'bottom']) > -1) objOpts.valign = $(cell).css('vertical-align');\r\n\r\n                    // C: Add padding [margin] (if any)\r\n                    // NOTE: Margins translate: px->pt 1:1 (e.g.: a 20px padded cell looks the same in PPTX as 20pt Text Inset/Padding)\r\n                    if ($(cell).css('padding-left')) {\r\n                        objOpts.marginPt = [];\r\n                        $.each(['padding-top', 'padding-right', 'padding-bottom', 'padding-left'], function (i, val) {\r\n                            objOpts.marginPt.push(Math.round($(cell).css(val).replace(/\\D/gi, '') * ONEPT));\r\n                        });\r\n                    }\r\n\r\n                    // D: Add colspan (if any)\r\n                    if ($(cell).attr('colspan')) objOpts.colspan = $(cell).attr('colspan');\r\n\r\n                    // E: Add border (if any)\r\n                    if ($(cell).css('border-top-width') || $(cell).css('border-right-width') || $(cell).css('border-bottom-width') || $(cell).css('border-left-width')) {\r\n                        objOpts.border = [];\r\n                        $.each(['top', 'right', 'bottom', 'left'], function (i, val) {\r\n                            var intBorderW = Math.round(Number($(cell).css('border-' + val + '-width').replace('px', '')));\r\n                            var arrRGB = [];\r\n                            arrRGB = $(cell).css('border-' + val + '-color').replace(/\\s+/gi, '').replace('rgba(', '').replace('rgb(', '').replace(')', '').split(',');\r\n                            var strBorderC = rgbToHex(Number(arrRGB[0]), Number(arrRGB[1]), Number(arrRGB[2]));\r\n                            objOpts.border.push({\r\n                                pt: intBorderW,\r\n                                color: strBorderC\r\n                            });\r\n                        });\r\n                    }\r\n\r\n                    // F: Massage cell text so we honor linebreak tag as a line break during line parsing\r\n                    var $cell = $(cell).clone();\r\n                    $cell.html($(cell).html().replace(/<br[^>]*>/gi, '\\n'));\r\n\r\n                    // LAST: Add cell\r\n                    arrObjTabCells.push({\r\n                        text: $cell.text(),\r\n                        opts: objOpts\r\n                    });\r\n                });\r\n                switch (val) {\r\n                    case 'thead':\r\n                        arrObjTabHeadRows.push(arrObjTabCells);\r\n                        break;\r\n                    case 'tbody':\r\n                        arrObjTabBodyRows.push(arrObjTabCells);\r\n                        break;\r\n                    case 'tfoot':\r\n                        arrObjTabFootRows.push(arrObjTabCells);\r\n                        break;\r\n                    default:\r\n                }\r\n            });\r\n        });\r\n    }\r\n    paginateData(arrObjTabHeadRows, arrObjTabBodyRows, arrObjTabFootRows, arrColW, emuTabCurrH, emuSlideTabH, arrRows, arrObjSlides, opts) {\r\n        $.each([arrObjTabHeadRows, arrObjTabBodyRows, arrObjTabFootRows], function (iTab, tab) {\r\n            var currRow = [];\r\n            $.each(tab, function (iRow, row) {\r\n                // A: Reset ROW variables\r\n                var arrCellsLines = [],\r\n                    arrCellsLineHeights = [],\r\n                    emuRowH = 0,\r\n                    intMaxLineCnt = 0,\r\n                    intMaxColIdx = 0;\r\n\r\n                // B: Parse and store each cell's text into line array (*MAGIC HAPPENS HERE*)\r\n                $(row).each(function (iCell, cell) {\r\n                    // 1: Create a cell object for each table column\r\n                    currRow.push({\r\n                        text: '',\r\n                        opts: cell.opts\r\n                    });\r\n\r\n                    // 2: Parse cell contents into lines (**MAGIC HAPENSS HERE**)\r\n                    var lines = parseTextToLines(cell.text, cell.opts.font_size, ( arrColW[iCell] / ONEPT ));\r\n                    arrCellsLines.push(lines);\r\n\r\n                    // 3: Keep track of max line count within all row cells\r\n                    if (lines.length > intMaxLineCnt) {\r\n                        intMaxLineCnt = lines.length;\r\n                        intMaxColIdx = iCell;\r\n                    }\r\n                });\r\n\r\n                // C: Calculate Line-Height\r\n                // FYI: Line-Height =~ font-size [px~=pt] * 1.65 / 100 = inches high\r\n                // FYI: 1px = 14288 EMU (0.156 inches) @96 PPI - I ended up going with 20000 EMU as margin spacing needed a bit more than 1:1\r\n                $(row).each(function (iCell, cell) {\r\n                    var lineHeight = inch2Emu(cell.opts.font_size * 1.65 / 100);\r\n                    if (Array.isArray(cell.opts.marginPt) && cell.opts.marginPt[0]) lineHeight += cell.opts.marginPt[0] / intMaxLineCnt;\r\n                    if (Array.isArray(cell.opts.marginPt) && cell.opts.marginPt[2]) lineHeight += cell.opts.marginPt[2] / intMaxLineCnt;\r\n                    arrCellsLineHeights.push(Math.round(lineHeight));\r\n                });\r\n\r\n                // D: AUTO-PAGING: Add text one-line-a-time to this row's cells until: lines are exhausted OR table H limit is hit\r\n                for (var idx = 0; idx < intMaxLineCnt; idx++) {\r\n                    // 1: Add the current line to cell\r\n                    for (var col = 0; col < arrCellsLines.length; col++) {\r\n                        // A: Commit this slide to Presenation if table Height limit is hit\r\n                        if (emuTabCurrH + arrCellsLineHeights[intMaxColIdx] > emuSlideTabH) {\r\n                            // 1: Add the current row to table\r\n                            // NOTE: Edge cases can occur where we create a new slide only to have no more lines\r\n                            // ....: and then a blank row sits at the bottom of a table!\r\n                            // ....: Hence, we very all cells have text before adding this final row.\r\n                            $.each(currRow, function (i, cell) {\r\n                                if (cell.text.length > 0) {\r\n                                    // IMPORTANT: use jQuery extend (deep copy) or cell will mutate!!\r\n                                    arrRows.push($.extend(true, [], currRow));\r\n                                    return false; // break out of .each loop\r\n                                }\r\n                            });\r\n                            // 2: Add new Slide with current array of table rows\r\n                            arrObjSlides.push($.extend(true, [], arrRows));\r\n                            // 3: Empty rows for new Slide\r\n                            arrRows.length = 0;\r\n                            // 4: Reset curr table height for new Slide\r\n                            emuTabCurrH = 0; // This row's emuRowH w/b added below\r\n                            // 5: Empty current row's text (continue adding lines where we left off below)\r\n                            $.each(currRow, function (i, cell) {\r\n                                cell.text = '';\r\n                            });\r\n                            // 6: Auto-Paging Options: addHeaderToEach\r\n                            if (opts.addHeaderToEach) {\r\n                                var headRow = [];\r\n                                $.each(arrObjTabHeadRows[0], function (iCell, cell) {\r\n                                    headRow.push({\r\n                                        text: cell.text,\r\n                                        opts: cell.opts\r\n                                    });\r\n                                    var lines = parseTextToLines(cell.text, cell.opts.font_size, ( arrColW[iCell] / ONEPT ));\r\n                                    if (lines.length > intMaxLineCnt) {\r\n                                        intMaxLineCnt = lines.length;\r\n                                        intMaxColIdx = iCell;\r\n                                    }\r\n                                });\r\n                                arrRows.push($.extend(true, [], headRow));\r\n                            }\r\n                        }\r\n\r\n                        // B: Add next line of text to this cell\r\n                        if (arrCellsLines[col][idx]) currRow[col].text += arrCellsLines[col][idx];\r\n                    }\r\n\r\n                    // 2: Add this new rows H to overall (The cell with the longest line array is the one we use as the determiner for overall row Height)\r\n                    emuTabCurrH += arrCellsLineHeights[intMaxColIdx];\r\n                }\r\n\r\n                // E: Flush row buffer - Add the current row to table, then truncate row cell array\r\n                // IMPORTANT: use jQuery extend (deep copy) or cell will mutate!!\r\n                arrRows.push($.extend(true, [], currRow));\r\n                currRow.length = 0;\r\n            }); // row loop\r\n        });\r\n    }\r\n    createSlides(arrObjSlides, opts, arrInchMargins, emuSlideTabW, arrColW) {\r\n        $.each(arrObjSlides, (i, slide) => {\r\n            // A: Create table row array\r\n            let arrTabRows = [];\r\n\r\n            // B: Create new Slide\r\n            let newSlide = ( opts && opts.master && gObjPptxMasters ) ? new Slide().addNewSlide(opts.master) : new Slide().addNewSlide();\r\n\r\n            // C: Create array of Rows\r\n            $.each(slide, (i, row) => {\r\n                var arrTabRowCells = [];\r\n                $.each(row, (i, cell) => {\r\n                    arrTabRowCells.push(cell);\r\n                });\r\n                arrTabRows.push(arrTabRowCells);\r\n            });\r\n\r\n            // D: Add table to Slide\r\n            newSlide.addTable(arrTabRows, {\r\n                x: arrInchMargins[3],\r\n                y: arrInchMargins[0],\r\n                cx: ( emuSlideTabW / EMU )\r\n            }, {\r\n                colW: arrColW\r\n            });\r\n\r\n            // E: Add any additional objects\r\n            if (opts.addImage) newSlide.addImage(opts.addImage.url, opts.addImage.x, opts.addImage.y, opts.addImage.w, opts.addImage.h);\r\n            if (opts.addText) newSlide.addText(opts.addText.text, ( opts.addText.opts || {} ));\r\n            if (opts.addShape) newSlide.addShape(opts.addShape.shape, ( opts.addShape.opts || {} ));\r\n            if (opts.addTable) newSlide.addTable(opts.addTable.rows, ( opts.addTable.opts || {} ), ( opts.addTable.tabOpts || {} ));\r\n        });\r\n    }\r\n    lookMargin(opts) {\r\n        var arrInchMargins = [0.5, 0.5, 0.5, 0.5]; // TRBL-style\r\n        if (opts && opts.margin) {\r\n            if (Array.isArray(opts.margin)) arrInchMargins = opts.margin;\r\n            else if (!isNaN(opts.margin)) arrInchMargins = [opts.margin, opts.margin, opts.margin, opts.margin];\r\n        } else if (opts && opts.master && opts.master.margin && gObjPptxMasters) {\r\n            if (Array.isArray(opts.master.margin)) arrInchMargins = opts.master.margin;\r\n            else if (!isNaN(opts.master.margin)) arrInchMargins = [opts.master.margin, opts.master.margin, opts.master.margin, opts.master.margin];\r\n        }\r\n        return arrInchMargins;\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/ppt/slides/table/slideTable.js"],"sourceRoot":""}